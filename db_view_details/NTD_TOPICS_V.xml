<ClarityDBViewQuery>
  <QueryResult code="NTD_TOPICS_V">
    <indexes/>
    <text_length>4515</text_length>
    <text>SELECT
      NTD_TOPICS.TOPIC_ID,
      NTD_TOPICS.LABEL,
      NTD_TOPICS.DESCRIPTION,
      NTD_TOPICS.GROUP_ID_OWNERS,
      NTD_TOPICS.OBJECT_TYPE_ID,
      NTD_TOPICS.OBJECT_ID,
      NTD_CORE_PKG.TOPIC_MESSAGES_COUNT (NTD_TOPICS.TOPIC_ID, ASSGNPERM.PRINCIPAL_ID) TOTAL_POSTS,
      NVL(NTD_CORE_PKG.TOPIC_MESSAGES_LAST_POST (NTD_TOPICS.TOPIC_ID, ASSGNPERM.PRINCIPAL_ID), NTD_TOPICS.CREATED_DATE) LAST_POST_DATE,
      ASSGNPERM.PRINCIPAL_ID USER_ID,
      NTD_TOPICS.CATEGORY_ID,
      NTD_TOPICS.ALL_PARENT_PARTICIPANTS,
      NTD_TOPICS.AUTHOR_ID,
      U2.FIRST_NAME,
      U2.LAST_NAME
FROM     CMN_SEC_USERS U2,
         CMN_SEC_USERS U1,
         NTD_TOPICS,
         CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE    NTD_TOPICS.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID = 1
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'USER'
AND      ASSGNPERM.PRINCIPAL_ID = U1.ID
AND      NTD_TOPICS.AUTHOR_ID = U2.ID
UNION
SELECT
      NTD_TOPICS.TOPIC_ID,
      NTD_TOPICS.LABEL,
      NTD_TOPICS.DESCRIPTION,
      NTD_TOPICS.GROUP_ID_OWNERS,
      NTD_TOPICS.OBJECT_TYPE_ID,
      NTD_TOPICS.OBJECT_ID,
      NTD_CORE_PKG.TOPIC_MESSAGES_COUNT (NTD_TOPICS.TOPIC_ID, ASSGNPERM.PRINCIPAL_ID) TOTAL_POSTS,
      NVL(NTD_CORE_PKG.TOPIC_MESSAGES_LAST_POST (NTD_TOPICS.TOPIC_ID, ASSGNPERM.PRINCIPAL_ID), NTD_TOPICS.CREATED_DATE) LAST_POST_DATE,
      ASSGNPERM.PRINCIPAL_ID USER_ID,
      NTD_TOPICS.CATEGORY_ID,
      NTD_TOPICS.ALL_PARENT_PARTICIPANTS,
      NTD_TOPICS.AUTHOR_ID,
      U2.FIRST_NAME,
      U2.LAST_NAME
FROM     CMN_SEC_USERS U2,
         CMN_SEC_USERS U1,
         NTD_TOPICS,
         CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE    NTD_TOPICS.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID = 5
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'USER'
AND      ASSGNPERM.PRINCIPAL_ID = U1.ID
AND      NTD_TOPICS.AUTHOR_ID = U2.ID
UNION
SELECT
      NTD_TOPICS.TOPIC_ID,
      NTD_TOPICS.LABEL,
      NTD_TOPICS.DESCRIPTION,
      NTD_TOPICS.GROUP_ID_OWNERS,
      NTD_TOPICS.OBJECT_TYPE_ID,
      NTD_TOPICS.OBJECT_ID,
      NTD_CORE_PKG.TOPIC_MESSAGES_COUNT (NTD_TOPICS.TOPIC_ID, UG.USER_ID) TOTAL_POSTS,
      NVL(NTD_CORE_PKG.TOPIC_MESSAGES_LAST_POST (NTD_TOPICS.TOPIC_ID, UG.USER_ID), NTD_TOPICS.CREATED_DATE) LAST_POST_DATE,
      UG.USER_ID USER_ID,
      NTD_TOPICS.CATEGORY_ID,
      NTD_TOPICS.ALL_PARENT_PARTICIPANTS,
      NTD_TOPICS.AUTHOR_ID,
      U2.FIRST_NAME,
      U2.LAST_NAME
FROM     CMN_SEC_USERS U2,
         CMN_SEC_USERS U1,
         CMN_SEC_USER_GROUPS UG,
         CMN_SEC_GROUPS PARENT_GROUP,
         CMN_SEC_GROUPS G,
	 CMN_SEC_GROUP_FLAT_HIERS H,
         NTD_TOPICS,
         CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE    NTD_TOPICS.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID = 1
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'GROUP'
AND	 ASSGNPERM.PRINCIPAL_ID = H.PARENT_GROUP_ID
AND      UG.GROUP_ID = H.GROUP_ID
AND      H.GROUP_ID = G.ID
AND      G.IS_ACTIVE = 1
AND      H.PARENT_GROUP_ID = PARENT_GROUP.ID
AND      PARENT_GROUP.IS_ACTIVE = 1
AND	 UG.USER_ID = U1.ID
AND      NTD_TOPICS.AUTHOR_ID = U2.ID
UNION
SELECT
      NTD_TOPICS.TOPIC_ID,
      NTD_TOPICS.LABEL,
      NTD_TOPICS.DESCRIPTION,
      NTD_TOPICS.GROUP_ID_OWNERS,
      NTD_TOPICS.OBJECT_TYPE_ID,
      NTD_TOPICS.OBJECT_ID,
      NTD_CORE_PKG.TOPIC_MESSAGES_COUNT (NTD_TOPICS.TOPIC_ID, UG.USER_ID) TOTAL_POSTS,
      NVL(NTD_CORE_PKG.TOPIC_MESSAGES_LAST_POST (NTD_TOPICS.TOPIC_ID, UG.USER_ID), NTD_TOPICS.CREATED_DATE) LAST_POST_DATE,
      UG.USER_ID USER_ID,
      NTD_TOPICS.CATEGORY_ID,
      NTD_TOPICS.ALL_PARENT_PARTICIPANTS,
      NTD_TOPICS.AUTHOR_ID,
      U2.FIRST_NAME,
      U2.LAST_NAME
FROM     CMN_SEC_USERS U2,
         CMN_SEC_USERS U1,
         CMN_SEC_USER_GROUPS UG,
         CMN_SEC_GROUPS PARENT_GROUP,
         CMN_SEC_GROUPS G,
	 CMN_SEC_GROUP_FLAT_HIERS H,
         NTD_TOPICS,
         CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE    NTD_TOPICS.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID = 5
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'GROUP'
AND	 ASSGNPERM.PRINCIPAL_ID = H.PARENT_GROUP_ID
AND      UG.GROUP_ID = H.GROUP_ID
AND      H.GROUP_ID = G.ID
AND      G.IS_ACTIVE = 1
AND      H.PARENT_GROUP_ID = PARENT_GROUP.ID
AND      PARENT_GROUP.IS_ACTIVE = 1
AND	 UG.USER_ID = U1.ID
AND      NTD_TOPICS.AUTHOR_ID = U2.ID
 </text>
  </QueryResult>
</ClarityDBViewQuery>
