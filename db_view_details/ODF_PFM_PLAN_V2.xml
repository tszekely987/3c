<ClarityDBViewQuery>
  <QueryResult code="ODF_PFM_PLAN_V2">
    <indexes/>
    <text_length>4467</text_length>
    <text>select   'x' pmd_analytical_partition_by, pfm_plans.id odf_pk, portfolio_id.finish_date as p_finish_date, (case when pfm_plans.id = (select port.plan_of_record from pfm_portfolios port where port.id = pfm_plans.portfolio_id) then 1 else 0 end ) as is_plan_of_record, pfm_plans.RESOURCES_CURVE as resources_curve, portfolio_id.operating_cost_curve as p_op_cost_curve, portfolio_id.resources_target as p_resources_target, portfolio_id.benefits_target as p_benefits_target, (NVL(PFM_PLANS.RESOURCES_TARGET,0)) as resources_target, pfm_plans.BENEFITS_CURVE as benefits_curve, pfm_plans.FINISH_DATE as finish_date, portfolio_id.capital_cost_target as p_cap_cost_target, (NVL(PFM_PLANS.CAPITAL_COST_TARGET,0)+NVL(PFM_PLANS.OPERATING_COST_TARGET,0)) as total_cost_target, pfm_plans.PORTFOLIO_ID as portfolio_id, (NVL(PFM_PLANS.CAPITAL_COST_TARGET,0)) as capital_cost_target, portfolio_id.code as plan_port_id, portfolio_id.total_cost_curve as p_total_cost_curve, portfolio_id.capital_cost_curve as p_cap_cost_curve, (NVL(PFM_PLANS.OPERATING_COST_TARGET,0)) as operating_cost_tgt, CREATED.FULL_NAME as created_by, portfolio_id.benefits_curve as p_benefits_curve, portfolio_id.operating_cost_tgt as p_op_cost_target, pfm_plans.OPERATING_COST_CURVE as operating_cost_curve, portfolio_id.total_cost_target as p_total_cost_target, pfm_plans.NAME as name, UPDATED.FULL_NAME as updated_by, UPDATED.ID as updated_by_id, CREATED.ID as created_by_id, portfolio_id.is_active as pf_is_active, pfm_plans.CODE as code, portfolio_id.resources_curve as p_resources_curve, portfolio_id.odf_period_end as odf_period_end, portfolio_id.odf_period_type as odf_period_type, pfm_plans.DESCRIPTION as description, portfolio_id.cap_unit_type as cap_unit_type, (NVL(PFM_PLANS.BENEFITS_TARGET,0)) as benefits_target, portfolio_id.currency_code as currency_code, portfolio_id.start_date as p_start_date, portfolio_id.odf_period_start as odf_period_start, (SELECT P.ID FROM CMN_PAGES P WHERE P.ID in
          (SELECT CASE WHEN CMN_PAGES.PRINCIPAL_TYPE = 'SYSTEM' THEN CMN_PAGES.ID
                  ELSE NVL(CMN_PAGES.ORIGINATING_PAGE_ID,CMN_PAGES.ID) END
          FROM CMN_INSTANCE_PAGES, CMN_PAGES
          WHERE CMN_INSTANCE_PAGES.PAGE_FRAME_ID = CMN_PAGES.ID
            AND CMN_INSTANCE_PAGES.OBJECT_TYPE = 'PFM_PLAN'
            AND CMN_INSTANCE_PAGES.OBJECT_INSTANCE_ID = PFM_PLANS.ID
          )
        ) as page_layout, pfm_plans.TOTAL_COST_CURVE as total_cost_curve, PFM_PLANS.LAST_UPDATED_DATE as last_updated_date, pfm_plans.START_DATE as start_date, pfm_plans.CAPITAL_COST_CURVE as capital_cost_curve, portfolio_id.name as portfolio_name, pfm_plans.is_approved as is_approved, PFM_PLANS.CREATED_DATE as created_date, odf_ca_pfm_plan.partition_code as partition_code, portfolio_id.odf_entity_code as odf_entity_code  from pfm_plans pfm_plans JOIN srm_resources CREATED ON CREATED.user_id=pfm_plans.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=pfm_plans.last_updated_by JOIN odf_ca_pfm_plan odf_ca_pfm_plan ON odf_ca_pfm_plan.id=pfm_plans.id JOIN (select   'x' pmd_analytical_partition_by, pfm_portfolios.id odf_pk, pfm_portfolios.BENEFITS_CURVE as benefits_curve, (NVL(PFM_PORTFOLIOS.CAPITAL_COST_TARGET,0)+NVL(PFM_PORTFOLIOS.OPERATING_COST_TARGET,0)) as total_cost_target, (NVL(PFM_PORTFOLIOS.CAPITAL_COST_TARGET,0)) as capital_cost_target, (NVL(PFM_PORTFOLIOS.OPERATING_COST_TARGET,0)) as operating_cost_tgt, pfm_portfolios.OPERATING_COST_CURVE as operating_cost_curve, odf_ca_pfm_portfolio.odf_period_type as odf_period_type, (NVL(PFM_PORTFOLIOS.BENEFITS_TARGET,0)) as benefits_target, pfm_portfolios.CURRENCY_CODE as currency_code, odf_ca_pfm_portfolio.odf_period_start as odf_period_start, pfm_portfolios.TOTAL_COST_CURVE as total_cost_curve, pfm_portfolios.START_DATE as start_date, pfm_portfolios.IS_ACTIVE as is_active, pfm_portfolios.RESOURCES_CURVE as resources_curve, (NVL(PFM_PORTFOLIOS.RESOURCES_TARGET,0)) as resources_target, pfm_portfolios.FINISH_DATE as finish_date, pfm_portfolios.NAME as name, pfm_portfolios.CODE as code, odf_ca_pfm_portfolio.odf_period_end as odf_period_end, pfm_portfolios.CAPACITY_UNIT_TYPE as cap_unit_type, pfm_portfolios.CAPITAL_COST_CURVE as capital_cost_curve, odf_ca_pfm_portfolio.odf_entity_code as odf_entity_code from pfm_portfolios pfm_portfolios JOIN odf_ca_pfm_portfolio odf_ca_pfm_portfolio ON odf_ca_pfm_portfolio.id=pfm_portfolios.id  where 1 = 1)  portfolio_id ON portfolio_id.odf_pk=pfm_plans.PORTFOLIO_ID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
