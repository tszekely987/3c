<ClarityDBViewQuery>
  <QueryResult code="DWH_TODO_V">
    <indexes/>
    <text_length>1090</text_length>
    <text>select prtodo.id odf_pk, PRTODO.ID as todo_key, PRTODO.ID as clarity_todo_key, prtodo.Name as todo_name, prtodo.position as position, prtodo.completed as is_completed, PRTASK.PRPROJECTID as investment_key, prtodo.prtaskid as task_key, prtodo.created_date as clarity_created_date, CASE WHEN PRTODO.LAST_UPDATED_DATE > PRTASK.LAST_UPDATED_DATE
	       THEN PRTODO.LAST_UPDATED_DATE ELSE PRTASK.LAST_UPDATED_DATE END as clarity_updated_date, CREATED.ID as created_by_key, 
        CREATED.FULL_NAME
      dwh_created_by_caption, UPDATED.ID as updated_by_key, 
        UPDATED.FULL_NAME
      dwh_updated_by_caption, PRTASK.PREXTERNALID as task_id, PRTASK.PRNAME as task_name, CMN_DATE_TRUNC_FCT(PRTODO.due_date) as due_date, NVL(TODOOWNER.ID,0) as owner_key, 
        TODOOWNER.FULL_NAME
      owner_caption from prtodo prtodo JOIN prtask prtask ON prtask.prid=prtodo.prtaskid JOIN srm_resources CREATED ON CREATED.user_id=prtodo.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=prtodo.last_updated_by LEFT OUTER JOIN srm_resources TODOOWNER ON PRTODO.owner = TODOOWNER.ID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
