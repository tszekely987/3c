<ClarityDBViewQuery>
  <QueryResult code="ODF_BENEFITPLANDETAIL_V2">
    <indexes/>
    <text_length>3393</text_length>
    <text>select   'x' pmd_analytical_partition_by, fin_benefit_plan_details.id odf_pk, plan_id.code as plan_code, plan_id.end_period_id as period_finish_id, plan_id.inv_name as inv_name, (SELECT CASE WHEN count(conv.id) > 0 THEN 1 ELSE 0 END FROM NMC_CONVERSATIONS conv WHERE conv.RESOURCE_NAME = 'benefitplandetail' AND conv.RESOURCE_ID = FIN_BENEFIT_PLAN_DETAILS.ID) as has_conversation, plan_id.currency_code as currency_code, fin_benefit_plan_details.ACTUAL_BENEFIT as actual_benefit, PERIOD_START_DATE.start_date as period_start, odf_ca_benefitplandetail.obj_benefit_subclass as obj_benefit_subclass, fin_benefit_plan_details.PERCENTAGE as percentage, fin_benefit_plan_details.TOTAL_ACTUAL_BENEFIT as total_actual_benefit, fin_benefit_plan_details.TOTAL_BILLING_BENEFIT as total_bill_benefit, FIN_BENEFIT_PLAN_DETAILS.last_updated_date as last_updated_date, fin_benefit_plan_details.TOTAL_BENEFIT as total_benefit, odf_ca_benefitplandetail.obj_benefit_class as obj_benefit_class, plan_id.bill_currency_code as bill_currency_code, plan_id.start_period_id as period_start_id, (NVL((SELECT 1 FROM DUAL WHERE EXISTS (SELECT 1 from NMC_CONVERSATIONS TC WHERE TC.RESOURCE_NAME='benefitplandetail' AND TC.RESOURCE_ID = fin_benefit_plan_details.id)), 0)) as has_conversations, PERIOD_END_DATE.end_date as period_finish, plan_id.object_id as object_id, fin_benefit_plan_details.BILLING_BENEFIT as bill_benefit, CREATED.FULL_NAME as created_by, plan_id.name as plan_name, fin_benefit_plan_details.BENEFIT as benefit, fin_benefit_plan_details.VARIANCE as variance, plan_id.inv_code as inv_code, UPDATED.FULL_NAME as updated_by, fin_benefit_plan_details.DETAIL as detail, FIN_BENEFIT_PLAN_DETAILS.created_date as created_date, odf_ca_benefitplandetail.partition_code as partition_code, fin_benefit_plan_details.PLAN_ID as plan_id, plan_id.period_type_code as period_type, plan_id.entity as entity  from fin_benefit_plan_details fin_benefit_plan_details JOIN fin_plans FIN_PLANS ON FIN_PLANS.id=FIN_BENEFIT_PLAN_DETAILS.plan_id LEFT OUTER JOIN biz_com_periods PERIOD_START_DATE ON PERIOD_START_DATE.period_type = FIN_PLANS.period_type_code and PERIOD_START_DATE.id = FIN_PLANS.start_period_id LEFT OUTER JOIN biz_com_periods PERIOD_END_DATE ON PERIOD_END_DATE.period_type = FIN_PLANS.period_type_code and PERIOD_END_DATE.id = FIN_PLANS.end_period_id JOIN srm_resources CREATED ON CREATED.user_id=FIN_BENEFIT_PLAN_DETAILS.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=FIN_BENEFIT_PLAN_DETAILS.last_updated_by JOIN odf_ca_benefitplandetail odf_ca_benefitplandetail ON odf_ca_benefitplandetail.id=fin_benefit_plan_details.id JOIN (select   'x' pmd_analytical_partition_by, fin_plans.id odf_pk, fin_plans.CODE as code, fin_plans.START_PERIOD_ID as start_period_id, INVESTMENTS.NAME as inv_name, ENTITY.HOME_CURRENCY_CODE as currency_code, fin_plans.END_PERIOD_ID as end_period_id, PROJECTS.BILLING_CURRENCY_CODE as bill_currency_code, fin_plans.OBJECT_ID as object_id, INVESTMENTS.CODE as inv_code, fin_plans.NAME as name, fin_plans.PERIOD_TYPE_CODE as period_type_code, ENTITY.ENTITY as entity from fin_plans fin_plans JOIN inv_investments INVESTMENTS ON INVESTMENTS.id=FIN_PLANS.object_id JOIN pac_mnt_projects PROJECTS ON PROJECTS.id=FIN_PLANS.object_id JOIN entity ENTITY ON ENTITY.entity=INVESTMENTS.entity_code where 1 = 1 )  plan_id ON plan_id.odf_pk=fin_benefit_plan_details.PLAN_ID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
