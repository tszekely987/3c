<ClarityDBViewQuery>
  <QueryResult code="RPT_PRJ_W_PLAN_COST_V">
    <indexes/>
    <text_length>777</text_length>
    <text>SELECT i.id PROJECT_ID,
       wc.start_date WEEK_START_DATE,
       SUM(NVL(CASE WHEN fp.plan_type_code = 'FORECAST' THEN s.slice ELSE 0 END,0)) FORECAST_COST,
       SUM(NVL(CASE WHEN fp.plan_type_code = 'BUDGET' THEN s.slice ELSE 0 END,0)) BUDGET_COST
FROM   inv_investments i, fin_plans fp, fin_cost_plan_details fd, odf_ssl_cst_dtl_cost s,
       rpt_calendar dc, rpt_calendar wc
WHERE  i.id = fp.object_id
AND    fp.plan_type_code IN ('FORECAST','BUDGET')
AND    fp.is_plan_of_record = 1
AND    fp.id = fd.plan_id
AND    fd.id = s.prj_object_id
AND    dc.start_date BETWEEN s.start_date and s.finish_date - 1
AND    dc.period_type = 'DAILY'
AND    dc.start_date BETWEEN wc.start_date AND wc.end_date
AND    wc.period_type = 'WEEKLY'
GROUP BY i.id, wc.start_date
 
 
 
 
 </text>
  </QueryResult>
</ClarityDBViewQuery>
