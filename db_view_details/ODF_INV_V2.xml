<ClarityDBViewQuery>
  <QueryResult code="ODF_INV_V2">
    <indexes/>
    <text_length>13047</text_length>
    <text>select   'x' pmd_analytical_partition_by, inv_investments.id odf_pk, inv_investments.APPROVEDBY_ID as approvedby_id, (SELECT ix.NAME FROM INV_INVESTMENTS ix WHERE ix.ID = INV_INVESTMENTS.IDEA_ID) as idea_name, inv_investments.RCF_FLEXIBILITY as inv_rcf_flexibility, odf_ca_inv.clr_cofund_currency as clr_cofund_currency, inv_investments.RCF_HUMAN_INTERFACE as inv_rcf_human_intrf, inv_investments.IS_CUSTOM as is_custom, inv_investments.STATUS_INDICATOR as status_indicator, inv_investments.code as unique_code, (case when inv_investments.schedule_start is not null and inv_investments.schedule_finish is not null THEN
        (NVL(INV_INVESTMENTS.LABOR_ACTSUM,0) / 3600 / PRJ_HPD_FACTOR_FCT())
    ELSE 0 end) as labor_actsum, odf_ca_inv.odf_asr_reports as odf_asr_reports, odf_ca_inv.clr_go_live as clr_go_live, (case when inv_investments.schedule_start is not null and inv_investments.schedule_finish is not null THEN
        (NVL(INV_INVESTMENTS.LABOR_ETCSUM,0) / 3600 / PRJ_HPD_FACTOR_FCT())
    ELSE 0 end) as labor_etcsum, inv_investments.RCF_SPONSORSHIP as inv_rcf_sponsorship, inv_investments.priority as priority, (SELECT e.ID FROM ENTITY e WHERE e.ENTITY = INV_INVESTMENTS.ENTITY_CODE) as entity_id, (select I.odf_object_code from ODF_CA_INV I where I.id = INV_INVESTMENTS.PARENT_ID) as parent_type, odf_ca_inv.clr_cofund as clr_cofund, odf_ca_inv.obj_pfl_category1 as obj_pfl_category1, odf_ca_inv.obj_pfl_category2 as obj_pfl_category2, INV_INVESTMENTS.odf_object_code as investment_type, inv_investments.labor_act_curve as labor_act, inv_investments.labor_etc_curve as labor_etc, inv_investments.labor_alloc_curve as labor_alloc, odf_ca_inv.obj_pfl_category3 as obj_pfl_category3, odf_ca_inv.obj_pfl_category4 as obj_pfl_category4, UPDATED.FULL_NAME as updated_by, inv_investments.STAGE_CODE as stage_code, NVL(inv_investments.odf_blueprint_id, (select id from odf_blueprints b where b.type = NLS_UPPER(inv_investments.odf_object_code) and b.is_default = 1)) as odf_blp_active_id, odf_ca_inv.obj_align_factor2 as obj_align_factor2, ( select count('x')
          from INV_INVESTMENTS bpInv, INV_PROJECTS ivp
          where INV_INVESTMENTS.ODF_OBJECT_CODE = 'project'
          and INV_INVESTMENTS.id = ivp.prid
          and ivp.is_template = 1
          and bpInv.odf_template_id = INV_INVESTMENTS.id ) as odf_invs_using_tmplt, odf_ca_inv.obj_align_factor1 as obj_align_factor1, UPDATED.ID as updated_by_id, odf_ca_inv.obj_align_factor4 as obj_align_factor4, odf_ca_inv.obj_align_factor3 as obj_align_factor3, (NVL((select fin_financials.planned_cst_total
        from fin_financials, odf_object_instance_mapping
        where odf_object_instance_mapping.primary_object_instance_id = inv_investments.id
        and odf_object_instance_mapping.secondary_object_instance_id = fin_financials.id
    and odf_object_instance_mapping.primary_object_instance_code = inv_investments.odf_object_code
    and odf_object_instance_mapping.secondary_object_instance_code = 'financials'  ), 0))
    -(NVL((SELECT SUM(b.totalcost) FROM ppa_wip a, ppa_wip_values
        b WHERE a.transno = b.transno AND b.currency_type = 'HOME'
        and a.status = 0
    AND a.investment_id = inv_investments.id GROUP BY
        a.investment_id),0)) as cost_variance, (SELECT bp.NAME FROM INV_INVESTMENTS bp WHERE bp.ID = INV_INVESTMENTS.ODF_TEMPLATE_ID) as odf_template_name, odf_ca_inv.obj_align_factor6 as obj_align_factor6, odf_ca_inv.obj_align_factor5 as obj_align_factor5, inv_investments.STATUS as status, (
          SELECT LISTAGG( value , ', ') WITHIN GROUP (ORDER BY value)  FROM
          (

            select  omvl2.value
            from
            odf_multi_valued_lookups omvl
            inner join inv_investments inv on inv.ODF_OBJECT_CODE || ':' || inv.id = omvl.value and omvl.object = 'odf_agreement'
            and omvl.attribute = 'successors'
            inner join odf_multi_valued_lookups omvl2 on omvl2.pk_id = omvl.pk_id and omvl2.object = 'odf_agreement' and omvl2.attribute = 'predecessors'
            where
            inv.id = INV_INVESTMENTS.ID
            FETCH NEXT 25 ROWS ONLY
          )
        ) as invagmntpredecessors, odf_ca_inv.obj_int_lastsync_sts as obj_int_lastsync_sts, odf_ca_inv.odf_period_type as odf_period_type, inv_investments.CURRENCY_CODE as currency_code, odf_ca_inv.odf_period_start as odf_period_start, inv_investments.MANAGER_ID as manager_id, odf_ca_inv.obj_int_format_id as obj_int_format_id, inv_investments.labor_variance_curve as labor_variance, inv_investments.labor_baseline_curve as labor_base, odf_ca_inv.odf_object_code as odf_object_code, inv_investments.IS_ACTIVE as is_active, INV_INVESTMENTS.MANAGER_ID as manager, inv_investments.STATUS_COMMENT as status_comment, (case when inv_investments.schedule_start is not null and inv_investments.schedule_finish is not null THEN
        (NVL(INV_INVESTMENTS.LABOR_EACSUM,0) / 3600 / PRJ_HPD_FACTOR_FCT())
    ELSE 0 end) as labor_eacsum, inv_investments.RCF_IMPLEMENTATION as inv_rcf_impl, inv_investments.RCF_ORG_CULTURE as inv_rcf_org_culture, inv_investments.PROGRESS as progress, inv_investments.entity_code as entity, inv_investments.GOAL_CODE as goal_code, inv_investments.schedule_finish as schedule_finish, inv_investments.labor_eac_curve as labor_eac, inv_investments.RCF_FUNDING as inv_rcf_funding, inv_investments.SLA_COMPLIANCE as sla_compliance, inv_investments.cbk_type as cbk_type, inv_investments.ODF_TEMPLATE_ID as odf_template_id, NVL(INV_INVESTMENTS.PURGE_FLAG,0) as purge_flag, (SELECT COUNT(1) FROM DUAL WHERE EXISTS (SELECT 1 FROM odf_multi_valued_lookups WHERE object = 'odf_agreement' AND attribute IN (
	    'successors' , 'predecessors' ) AND value = CONCAT(CONCAT(INV_INVESTMENTS.ODF_OBJECT_CODE,':'),INV_INVESTMENTS.id))) as inv_has_agreements, inv_investments.schedule_start as schedule_start, inv_investments.RCF_OBJECTIVES as inv_rcf_objectives, odf_ca_inv.obj_work_status as obj_work_status, inv_investments.IDEA_ID as idea_id, inv_investments.ASSGN_POOL as assgn_pool, inv_investments.CI_PROGRESS as ci_progress, CREATED.FULL_NAME as created_by, (SELECT count(id) FROM cmn_lookups_v WHERE parent_lookup_code = INV_INVESTMENTS.process_code AND is_active = 1 AND language_code = 'en') as stage_count, inv_investments.TARGET_MANAGER_ID as target_manager_id, inv_investments.labor_hard_alloc_curve as labor_hard_alloc, inv_investments.RCF_INTERDEPENDENCY as inv_rcf_interdepend, inv_investments.plan_inv_category as plan_inv_category, (case when inv_investments.schedule_start is not null and inv_investments.schedule_finish is not null
          THEN (NVL(INV_INVESTMENTS.LABOR_VARIANCESUM,0) / 3600 / PRJ_HPD_FACTOR_FCT())
          ELSE 0
        end) as labor_variancesum, inv_investments.parent_id as odf_assoc_parent, inv_investments.RCF_SUPPORTABILITY as inv_rcf_support, inv_investments.name as name, (CASE WHEN (nvl2((odf_ca_inv.obj_align_factor1*1),1,0)+nvl2((odf_ca_inv.obj_align_factor2*1),1,0)+nvl2((odf_ca_inv.obj_align_factor3*1),1,0)+nvl2((odf_ca_inv.obj_align_factor4*1),1,0)+nvl2((odf_ca_inv.obj_align_factor5*1),1,0)+nvl2((odf_ca_inv.obj_align_factor6*1),1,0))=0 THEN NULL ELSE (nvl((odf_ca_inv.obj_align_factor1*1),0)+nvl((odf_ca_inv.obj_align_factor2*1),0)+nvl((odf_ca_inv.obj_align_factor3*1),0)+nvl((odf_ca_inv.obj_align_factor4*1),0)+nvl((odf_ca_inv.obj_align_factor5*1),0)+nvl((odf_ca_inv.obj_align_factor6*1),0))/(nvl2((odf_ca_inv.obj_align_factor1*1),1,0)+nvl2((odf_ca_inv.obj_align_factor2*1),1,0)+nvl2((odf_ca_inv.obj_align_factor3*1),1,0)+nvl2((odf_ca_inv.obj_align_factor4*1),1,0)+nvl2((odf_ca_inv.obj_align_factor5*1),1,0)+nvl2((odf_ca_inv.obj_align_factor6*1),1,0)) END ) as obj_alignment, CREATED.ID as created_by_id, inv_investments.ALIGNMENT as alignment, (
        SELECT LISTAGG( value , ', ') WITHIN GROUP (ORDER BY value)  FROM
        (
          select  omvl2.value
          from
          odf_multi_valued_lookups omvl
          inner join inv_investments inv on inv.ODF_OBJECT_CODE || ':' || inv.id = omvl.value and omvl.object = 'odf_agreement'
          and omvl.attribute = 'predecessors'
          inner join odf_multi_valued_lookups omvl2 on omvl2.pk_id = omvl.pk_id and omvl2.object = 'odf_agreement' and omvl2.attribute = 'successors'
          where
          inv.id = INV_INVESTMENTS.ID
          FETCH NEXT 25 ROWS ONLY
          )
        ) as invagmntsuccessors, NVL((SELECT count(ID) FROM cmn_lookups_v WHERE parent_lookup_code = INV_INVESTMENTS.process_code AND language_code = 'en' AND IS_ACTIVE = 1 AND SORT_ORDER &lt;= (select sort_order from cmn_lookups_v WHERE lookup_code = INV_INVESTMENTS.stage_code AND lookup_type='INV_STAGE_TYPE' AND language_code = 'en')),0) as stage_number, inv_investments.is_open_for_te as isopen, inv_investments.RCF_RESOURCE_AVAIL as inv_rcf_res_avail, odf_ca_inv.odf_period_end as odf_period_end, inv_investments.TRACK_ASSGN_ONLY as track_assgn_only, inv_investments.description as description, (SELECT NVL(SUM (b.totalcost), 0) FROM ppa_wip a, ppa_wip_values b
         WHERE a.transno = b.transno AND b.currency_type = 'HOME'
        AND a.status = 0
        AND a.investment_id = inv_investments.id GROUP BY a.investment_id) as aggr_actual_cost, (SELECT COUNT(1) FROM DUAL WHERE EXISTS (SELECT PRID FROM PRTEAM WHERE PRTEAM.PRPROJECTID = INV_INVESTMENTS.ID)) as has_staff, inv_investments.CI_STAGE as ci_stage, inv_investments.APPROVEDTIME as approvedtime, odf_ca_inv.vsm_lean_bc as vsm_lean_bc, inv_investments.IS_REQUIRED as is_required, inv_investments.BASELINE_ID as baseline_id, INV_INVESTMENTS.LAST_UPDATED_DATE as last_updated_date, inv_investments.SYNC_INV_N_BDG_DATES as sync_inv_n_bdg_dates, INV_INVESTMENTS.odf_object_code as inv_type, ((NVL(INV_INVESTMENTS.LABOR_ETCSUM,0) + NVL(INV_INVESTMENTS.LABOR_ACTSUM,0)) / 3600 / PRJ_HPD_FACTOR_FCT()) as labor_effort, inv_investments.track_mode as trackmode, (CASE WHEN (nvl2((inv_investments.RCF_FLEXIBILITY*1),1,0)+nvl2((inv_investments.RCF_FUNDING*1),1,0)+nvl2((inv_investments.RCF_HUMAN_INTERFACE*1),1,0)+nvl2((inv_investments.RCF_IMPLEMENTATION*1),1,0)+nvl2((inv_investments.RCF_INTERDEPENDENCY*1),1,0)+nvl2((inv_investments.RCF_OBJECTIVES*1),1,0)+nvl2((inv_investments.RCF_ORG_CULTURE*1),1,0)+nvl2((inv_investments.RCF_RESOURCE_AVAIL*1),1,0)+nvl2((inv_investments.RCF_SPONSORSHIP*1),1,0)+nvl2((inv_investments.RCF_SUPPORTABILITY*1),1,0)+nvl2((inv_investments.RCF_TECHNICAL*1),1,0))=0 THEN NULL ELSE (nvl((inv_investments.RCF_FLEXIBILITY*1),0)+nvl((inv_investments.RCF_FUNDING*1),0)+nvl((inv_investments.RCF_HUMAN_INTERFACE*1),0)+nvl((inv_investments.RCF_IMPLEMENTATION*1),0)+nvl((inv_investments.RCF_INTERDEPENDENCY*1),0)+nvl((inv_investments.RCF_OBJECTIVES*1),0)+nvl((inv_investments.RCF_ORG_CULTURE*1),0)+nvl((inv_investments.RCF_RESOURCE_AVAIL*1),0)+nvl((inv_investments.RCF_SPONSORSHIP*1),0)+nvl((inv_investments.RCF_SUPPORTABILITY*1),0)+nvl((inv_investments.RCF_TECHNICAL*1),0))/(nvl2((inv_investments.RCF_FLEXIBILITY*1),1,0)+nvl2((inv_investments.RCF_FUNDING*1),1,0)+nvl2((inv_investments.RCF_HUMAN_INTERFACE*1),1,0)+nvl2((inv_investments.RCF_IMPLEMENTATION*1),1,0)+nvl2((inv_investments.RCF_INTERDEPENDENCY*1),1,0)+nvl2((inv_investments.RCF_OBJECTIVES*1),1,0)+nvl2((inv_investments.RCF_ORG_CULTURE*1),1,0)+nvl2((inv_investments.RCF_RESOURCE_AVAIL*1),1,0)+nvl2((inv_investments.RCF_SPONSORSHIP*1),1,0)+nvl2((inv_investments.RCF_SUPPORTABILITY*1),1,0)+nvl2((inv_investments.RCF_TECHNICAL*1),1,0)) END ) as risk_score, inv_investments.RSF_OBS_UNIT as rsf_obs_unit, inv_investments.RCF_TECHNICAL as inv_rcf_technical, odf_ca_inv.obj_int_mappings as obj_int_mappings, inv_investments.chargecodeid as chargecodeid, inv_investments.ODF_BLUEPRINT_ID as odf_blueprint_id, (SELECT INV.ODF_OBJECT_CODE
          FROM INV_INVESTMENTS INV, ODF_OBJECTS O
          WHERE INV.ID = INV_INVESTMENTS.PARENT_ID
          AND INV.ODF_OBJECT_CODE = O.CODE) as parent_type_code, odf_ca_inv.obj_int_lastsync_msg as obj_int_lastsync_msg, odf_ca_inv.odf_asr_template as odf_asr_template, inv_investments.ODF_TEMPLATE as odf_template, ( select max(bpInv.created_date)
          from INV_INVESTMENTS bpInv, INV_PROJECTS ivp
          where INV_INVESTMENTS.ODF_OBJECT_CODE = 'project'
          and INV_INVESTMENTS.id = ivp.prid
          and ivp.is_template = 1
          and bpInv.odf_template_id = INV_INVESTMENTS.id ) as odf_tmplt_last_used, odf_ca_inv.obj_int_ext_object as obj_int_ext_object, (CASE WHEN INV_INVESTMENTS.STATUS = 1 THEN 1 WHEN INV_INVESTMENTS.STATUS = 5 THEN 1 WHEN INV_INVESTMENTS.STATUS = 8 THEN 1 ELSE 0 END) as is_approved, inv_investments.bill_expense_type as bill_expense_type, inv_investments.RISK as risk, INV_INVESTMENTS.CREATED_DATE as created_date, (NVL(INV_INVESTMENTS.LABOR_BASESUM,0) / 3600 / PRJ_HPD_FACTOR_FCT()) as labor_basesum, odf_ca_inv.obj_int_source as obj_int_source  from inv_investments inv_investments JOIN srm_resources CREATED ON CREATED.user_id=inv_investments.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=inv_investments.last_updated_by JOIN odf_ca_inv odf_ca_inv ON odf_ca_inv.id=inv_investments.id  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
