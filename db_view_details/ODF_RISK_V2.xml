<ClarityDBViewQuery>
  <QueryResult code="ODF_RISK_V2">
    <indexes/>
    <text_length>4825</text_length>
    <text>select   'x' pmd_analytical_partition_by, rim_risks_and_issues.id odf_pk, rim_risks_and_issues.PK_ID as pk_id, rim_risks_and_issues.RESOLVED_DATE as resolved_date, rim_risks_and_issues.RIM_RISK_ISSUE_CODE as rim_risk_issue_code, inv_investments.NAME as inv_name, rim_risks_and_issues.TABLE_NAME as table_name, rim_risks_and_issues.RESOLUTION as resolution, rim_risks_and_issues.ASSUMPTIONS as assumptions, RIM_RISKS_AND_ISSUES.PROBABILITY_ENUM * RIM_RISKS_AND_ISSUES.IMPACT_ENUM as calculated_risk, rim_risks_and_issues.RESOLVED_BY as resolved_by, rim_risks_and_issues.PROBABILITY_ENUM as probability, rim_risks_and_issues.IMPACT_ENUM as impact, (NVL((SELECT 1 FROM DUAL WHERE EXISTS (SELECT 1 from NMC_CONVERSATIONS TC WHERE TC.RESOURCE_NAME='risk' AND TC.RESOURCE_ID = rim_risks_and_issues.id)), 0)) as has_conversations, rim_risks_and_issues.APPROACH_CODE as approach_code, CREATED.FULL_NAME as created_by, rim_risks_and_issues.PARENT_RISK_ISSUE_ID as parent_risk_issue_id, pk_id.unique_code as pk_unique_name, rim_risks_and_issues.PRIORITY_CODE as priority_code, rim_risks_and_issues.NAME as name, UPDATED.FULL_NAME as updated_by, rim_risks_and_issues.RISK_SYMPTOMS as risk_symptoms, rim_risks_and_issues.PK_ID as odf_parent_id, UPDATED.ID as updated_by_id, CREATED.ID as created_by_id, rim_risks_and_issues.IMPACT_DATE as impact_date, rim_risks_and_issues.TYPE_CODE as type_code, rim_risks_and_issues.STATUS_CODE as status_code, rim_risks_and_issues.DOCUMENT as document, pk_id.odf_period_end as odf_period_end, pk_id.odf_period_type as odf_period_type, rim_risks_and_issues.DESCRIPTION as description, (SELECT CASE WHEN count(conv.id) > 0 THEN 1 ELSE 0 END FROM NMC_CONVERSATIONS conv WHERE conv.RESOURCE_NAME = 'risk' AND conv.RESOURCE_ID = RIM_RISKS_AND_ISSUES.ID) as has_conversation, (SELECT R.RIM_RISK_ISSUE_CODE FROM RIM_RISKS_AND_ISSUES R WHERE
        R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID) as p_risk_issue_name, pk_id.odf_period_start as odf_period_start, odf_ca_risk.odmd_rpting as odmd_rpting, RIM_RISKS_AND_ISSUES.LAST_UPDATED_DATE as last_updated_date, (CASE WHEN RIM_RISKS_AND_ISSUES.PK_ID = (SELECT ID FROM INV_INVESTMENTS INV WHERE ODF_OBJECT_CODE = 'project' AND ID = RIM_RISKS_AND_ISSUES.PK_ID) THEN RIM_RISKS_AND_ISSUES.PK_ID ELSE NULL END) as prprojectid, rim_risks_and_issues.ASSIGNED_TO as assigned_to, rim_risks_and_issues.IMPACT_DESCRIPTION as impact_description, rim_risks_and_issues.CATEGORY_TYPE_CODE as category_type, (CASE WHEN RIM_RISKS_AND_ISSUES.IMPACT_ENUM * RIM_RISKS_AND_ISSUES.PROBABILITY_ENUM > (SELECT
        NVL(VALUE,0) FROM CMN_OPTIONS O, CMN_OPTION_VALUES OV WHERE O.OPTION_CODE = 'RIM_RISK_THRESHOLD' AND O.ID =
        OV.OPTION_ID) THEN 1 ELSE 0 END) as is_above_threshold, rim_risks_and_issues.TARGET_RESOLUTION_DATE as target_resolve_date, pk_id.name as pk_name, (select value from cmn_option_values where option_id= (select id from cmn_options where
        option_code='RIM_RISK_THRESHOLD')) as risk_threshold, RIM_RISKS_AND_ISSUES.CREATED_DATE as created_date, odf_ca_risk.partition_code as partition_code, pk_id.entity as odf_entity_code  from rim_risks_and_issues rim_risks_and_issues JOIN srm_resources CREATED ON CREATED.user_id=rim_risks_and_issues.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=rim_risks_and_issues.last_updated_by JOIN inv_investments inv_investments ON inv_investments.id=rim_risks_and_issues.pk_id JOIN odf_ca_risk odf_ca_risk ON odf_ca_risk.id=rim_risks_and_issues.id JOIN (select odf_inv.odf_pk,odf_inv.unique_code,odf_inv.name,odf_project.entity,odf_project.odf_period_end,odf_project.odf_period_start,odf_project.odf_period_type from (select   'x' pmd_analytical_partition_by, inv_investments.id odf_pk, inv_investments.code as unique_code, inv_investments.name as name from inv_investments inv_investments where 1 = 1 ) odf_inv left outer join (select   'x' pmd_analytical_partition_by, inv_investments.id odf_pk, inv_investments.entity_code as entity, odf_ca_inv.odf_period_type as odf_period_type, odf_ca_inv.odf_period_start as odf_period_start, odf_ca_inv.odf_period_end as odf_period_end from inv_investments inv_investments JOIN pac_mnt_projects PAC_MNT_PROJECTS ON PAC_MNT_PROJECTS.id=inv_investments.id JOIN odf_ca_inv odf_ca_inv ON odf_ca_inv.id=inv_investments.id join odf_object_instance_mapping oim1 on inv_investments.id = oim1.primary_object_instance_id  and oim1.primary_object_instance_code='project' join fin_financials fin_financials on oim1.secondary_object_instance_id = fin_financials.id and oim1.secondary_object_instance_code='financials' JOIN odf_ca_financials odf_ca_financials ON odf_ca_financials.id=FIN_FINANCIALS.id where 1 = 1 ) odf_project on odf_inv.odf_pk = odf_project.odf_pk )  pk_id ON pk_id.odf_pk=rim_risks_and_issues.PK_ID  where 1 = 1 and rim_risks_and_issues.TYPE_CODE = 'RISK'</text>
  </QueryResult>
</ClarityDBViewQuery>
