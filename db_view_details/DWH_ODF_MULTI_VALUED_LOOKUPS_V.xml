<ClarityDBViewQuery>
  <QueryResult code="DWH_ODF_MULTI_VALUED_LOOKUPS_V">
    <indexes/>
    <text_length>2153</text_length>
    <text>(SELECT   /*+ INDEX(MVL,ODF_MULTI_VALUED_LOOKUPS_N3) */
          UPPER(DWC.OBJECT_CODE) OBJECT_CODE,
          UPPER(DWC.DWH_TABLE_NAME) TABLE_NAME,
          UPPER(DWC.DWH_COLUMN_NAME ||'_key') COLUMN_NAME,
          MVL.PK_ID TABLE_RECORD_KEY,
          MVL.SEQ ORDER_NUMBER,
          NVL(MVL.DWH_VALUE, MVL.VALUE) LOOKUP_VALUE_KEY,
          UPPER(DWC.LKP_DIM_TABLE_NAME) DWH_LKP_TABLE_NAME,
          DWC.DIM_DISPLAY DIM_DISPLAY,
          DWC.DIM_KEY DIM_KEY,
          UPPER(CASE WHEN DWC.DIM_KEY IS NULL THEN DWT.dwh_key_column ELSE DWC.DIM_KEY END) AS DWH_LKP_KEY_COLUMN,
          MVL.CREATED_DATE CLARITY_CREATED_DATE,
          MVL.LAST_UPDATED_DATE CLARITY_UPDATED_DATE
   FROM   DWH_META_TABLES DWT,
          DWH_META_COLUMNS DWC,
          ODF_MULTI_VALUED_LOOKUPS MVL
   WHERE  SUBSTR(MVL.OBJECT,1,CASE WHEN INSTR(MVL.OBJECT,'~') = 0 THEN 30 ELSE INSTR(MVL.OBJECT,'~')-1 END) = DWC.OBJECT_CODE
   AND    MVL.VALUE IS NOT NULL
   AND    MVL.ATTRIBUTE ||'_caption' = DWC.ATTRIBUTE_CODE
   AND    UPPER(DWT.DWH_TABLE_NAME) = UPPER(DWC.LKP_DIM_TABLE_NAME)
   AND    DWC.IS_DELETED = 0
   UNION  ALL
  SELECT  UPPER(DWC.OBJECT_CODE) OBJECT_CODE,
          UPPER(DWC.DWH_TABLE_NAME) TABLE_NAME,
          UPPER(DWC.DWH_COLUMN_NAME ||'_key') COLUMN_NAME,
          MVL.PK_ID TABLE_RECORD_KEY,
          MVL.SEQ ORDER_NUMBER,
          NVL(MVL.DWH_VALUE, MVL.VALUE) LOOKUP_VALUE_KEY,
          UPPER(DWC.LKP_DIM_TABLE_NAME) DWH_LKP_TABLE_NAME,
          DWC.DIM_DISPLAY DIM_DISPLAY,
          DWC.DIM_KEY DIM_KEY,
          UPPER(CASE WHEN DWC.DIM_KEY IS NULL THEN DWT.dwh_key_column ELSE DWC.DIM_KEY END) AS DWH_LKP_KEY_COLUMN,
          MVL.CREATED_DATE CLARITY_CREATED_DATE,
          MVL.LAST_UPDATED_DATE CLARITY_UPDATED_DATE
   FROM   DWH_META_TABLES DWT,
          DWH_META_COLUMNS DWC,
          ODF_OBJECT_EXTENSIONS OOE,
          ODF_MULTI_VALUED_LOOKUPS MVL
   WHERE  MVL.OBJECT = OOE.OBJECT_CODE
   AND    MVL.VALUE IS NOT NULL
   AND    OOE.EXTENSION_CODE = DWC.OBJECT_CODE
   AND    MVL.ATTRIBUTE ||'_caption' = DWC.ATTRIBUTE_CODE
   AND    UPPER(DWT.DWH_TABLE_NAME) = UPPER(DWC.LKP_DIM_TABLE_NAME)
   AND    DWC.IS_DELETED = 0)</text>
  </QueryResult>
</ClarityDBViewQuery>
