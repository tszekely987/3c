<ClarityDBViewQuery>
  <QueryResult code="DWH_DEPARTMENT_V">
    <indexes/>
    <text_length>1186</text_length>
    <text>select departments.id odf_pk, DEPARTMENTS.ID as department_key, departments.DEPARTCODE as department_id, departments.SHORTDESC as department, departments.ENTITY_ID as entity_key, ENTITIES.ENTITY as entity_id, ENTITIES.SHORTDESC as entity, (
        CASE
        WHEN ENTITIES.CREATED_DATE IS NULL
          THEN DEPARTMENTS.CREATED_DATE
        ELSE
          GREATEST(DEPARTMENTS.CREATED_DATE, ENTITIES.CREATED_DATE)
        END
      ) as clarity_created_date, (
        CASE
        WHEN ENTITIES.LAST_UPDATED_DATE IS NULL
          THEN DEPARTMENTS.LAST_UPDATED_DATE
        ELSE
          GREATEST(DEPARTMENTS.LAST_UPDATED_DATE, ENTITIES.LAST_UPDATED_DATE)
        END
      ) as clarity_updated_date from departments departments join odf_object_instance_mapping oim1 on departments.id = oim1.primary_object_instance_id  and oim1.primary_object_instance_code='department' join fin_financials fin_financials on oim1.secondary_object_instance_id = fin_financials.id and oim1.secondary_object_instance_code='financials' JOIN odf_ca_financials odf_ca_financials ON odf_ca_financials.id=FIN_FINANCIALS.id LEFT OUTER JOIN entity ENTITIES ON DEPARTMENTS.ENTITY_ID=ENTITIES.ID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
