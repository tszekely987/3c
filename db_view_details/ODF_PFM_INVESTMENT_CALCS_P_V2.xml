<ClarityDBViewQuery>
  <QueryResult code="ODF_PFM_INVESTMENT_CALCS_P_V2">
    <indexes/>
    <text_length>9140</text_length>
    <text>select   'x' pmd_analytical_partition_by, pfm_investments.id odf_pk, ((CASE WHEN (EVREC.ITD_BCWS*1.00)=0 THEN NULL ELSE ((EVREC.ITD_BCWP*1.00)-(EVREC.ITD_BCWS*1.00))/(EVREC.ITD_BCWS*1.00) END )*(100.0*1.00)) as p_obj_ev_sv_pct, ((CASE WHEN (EVREC.ITD_BCWP*1.00)=0 THEN NULL ELSE ((EVREC.ITD_BCWP*1.00)-(EVREC.ITD_ACWP*1.00))/(EVREC.ITD_BCWP*1.00) END )*(100.0*1.00)) as p_obj_ev_cv_pct, (((NVL(PFM_INVESTMENTS.labor_eacsum,0)/3600)/(select hours_per_day from prj_hours_per_day_v)*1.00)-((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00)) as p_obj_effort_amt_var, (CASE WHEN (nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor1,PFM_CA_INV.obj_align_factor1)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor2,PFM_CA_INV.obj_align_factor2)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor3,PFM_CA_INV.obj_align_factor3)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor4,PFM_CA_INV.obj_align_factor4)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor5,PFM_CA_INV.obj_align_factor5)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor6,PFM_CA_INV.obj_align_factor6)*1),1,0))=0 THEN NULL ELSE (nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor1,PFM_CA_INV.obj_align_factor1)*1),0)+nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor2,PFM_CA_INV.obj_align_factor2)*1),0)+nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor3,PFM_CA_INV.obj_align_factor3)*1),0)+nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor4,PFM_CA_INV.obj_align_factor4)*1),0)+nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor5,PFM_CA_INV.obj_align_factor5)*1),0)+nvl((NVL(PFM_CA_INV_PLAN.obj_align_factor6,PFM_CA_INV.obj_align_factor6)*1),0))/(nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor1,PFM_CA_INV.obj_align_factor1)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor2,PFM_CA_INV.obj_align_factor2)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor3,PFM_CA_INV.obj_align_factor3)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor4,PFM_CA_INV.obj_align_factor4)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor5,PFM_CA_INV.obj_align_factor5)*1),1,0)+nvl2((NVL(PFM_CA_INV_PLAN.obj_align_factor6,PFM_CA_INV.obj_align_factor6)*1),1,0)) END ) as obj_alignment, pfm_investments.PORTFOLIO_ID as portfolio_id, (((EVREC.ETC*1.00)+(EVREC.ITD_ACWP*1.00))-(EVREC.BAC*1.00)) as p_obj_cost_amt_var, (CMN_DATE_TIME_DIFF_FCT('Day',NVL(PFM_INVESTMENTS_PLAN.schedule_finish,PFM_INVESTMENTS.schedule_finish),BASEREC.FINISH_DATE)) as p_obj_schedule_var, ((CASE WHEN ((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00)=0 THEN NULL ELSE (((NVL(PFM_INVESTMENTS.labor_eacsum,0)/3600)/(select hours_per_day from prj_hours_per_day_v)*1.00)-((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00))/((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00) END )*(100.0*1.00)) as p_obj_effort_var, ((CASE WHEN (EVREC.BAC*1.00)=0 THEN NULL ELSE (((EVREC.ETC*1.00)+(EVREC.ITD_ACWP*1.00))-(EVREC.BAC*1.00))/(EVREC.BAC*1.00) END )*(100.0*1.00)) as p_obj_cost_pct_var, pfm_investments.INVESTMENT_ID as investment_id , pfm_investments_plan.plan_id plan_id from pfm_investments pfm_investments LEFT OUTER JOIN pfm_investments_plan pfm_investments_plan ON PFM_INVESTMENTS.ID = PFM_INVESTMENTS_PLAN.ID LEFT OUTER JOIN pfm_projects pfm_projects ON PFM_INVESTMENTS.ID = PFM_PROJECTS.ID LEFT OUTER JOIN pfm_projects_plan pfm_projects_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_PROJECTS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_PROJECTS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_assets pfm_assets ON PFM_INVESTMENTS.ID = PFM_ASSETS.ID LEFT OUTER JOIN pfm_assets_plan pfm_assets_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_ASSETS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_ASSETS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_applications pfm_applications ON PFM_INVESTMENTS.ID = PFM_APPLICATIONS.ID LEFT OUTER JOIN pfm_applications_plan pfm_applications_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_APPLICATIONS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_APPLICATIONS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ideas pfm_ideas ON PFM_INVESTMENTS.ID = PFM_IDEAS.ID LEFT OUTER JOIN pfm_ideas_plan pfm_ideas_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_IDEAS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_IDEAS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_products pfm_products ON PFM_INVESTMENTS.ID = PFM_PRODUCTS.ID LEFT OUTER JOIN pfm_products_plan pfm_products_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_PRODUCTS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_PRODUCTS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_services pfm_services ON PFM_INVESTMENTS.ID = PFM_SERVICES.ID LEFT OUTER JOIN pfm_services_plan pfm_services_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_SERVICES_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_SERVICES_PLAN.PLAN_ID LEFT OUTER JOIN pfm_others pfm_others ON PFM_INVESTMENTS.ID = PFM_OTHERS.ID LEFT OUTER JOIN pfm_others_plan pfm_others_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_OTHERS_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_OTHERS_PLAN.PLAN_ID LEFT OUTER JOIN pfm_mnt_projects pfm_mnt_projects ON PFM_INVESTMENTS.ID = PFM_MNT_PROJECTS.ID LEFT OUTER JOIN pfm_financials pfm_financials ON PFM_INVESTMENTS.ID = PFM_FINANCIALS.ID LEFT OUTER JOIN pfm_ca_inv pfm_ca_inv ON PFM_INVESTMENTS.ID = PFM_CA_INV.ID LEFT OUTER JOIN pfm_ca_inv_plan pfm_ca_inv_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_INV_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_INV_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_project pfm_ca_project ON PFM_INVESTMENTS.ID = PFM_CA_PROJECT.ID LEFT OUTER JOIN pfm_ca_project_plan pfm_ca_project_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_PROJECT_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_PROJECT_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_asset pfm_ca_asset ON PFM_INVESTMENTS.ID = PFM_CA_ASSET.ID LEFT OUTER JOIN pfm_ca_asset_plan pfm_ca_asset_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_ASSET_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_ASSET_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_application pfm_ca_application ON PFM_INVESTMENTS.ID = PFM_CA_APPLICATION.ID LEFT OUTER JOIN pfm_ca_application_plan pfm_ca_application_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_APPLICATION_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_APPLICATION_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_other pfm_ca_other ON PFM_INVESTMENTS.ID = PFM_CA_OTHER.ID LEFT OUTER JOIN pfm_ca_other_plan pfm_ca_other_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_OTHER_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_OTHER_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_product pfm_ca_product ON PFM_INVESTMENTS.ID = PFM_CA_PRODUCT.ID LEFT OUTER JOIN pfm_ca_product_plan pfm_ca_product_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_PRODUCT_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_PRODUCT_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_service pfm_ca_service ON PFM_INVESTMENTS.ID = PFM_CA_SERVICE.ID LEFT OUTER JOIN pfm_ca_service_plan pfm_ca_service_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_SERVICE_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_SERVICE_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_idea pfm_ca_idea ON PFM_INVESTMENTS.ID = PFM_CA_IDEA.ID LEFT OUTER JOIN pfm_ca_idea_plan pfm_ca_idea_plan ON PFM_INVESTMENTS_PLAN.ID = PFM_CA_IDEA_PLAN.ID AND PFM_INVESTMENTS_PLAN.PLAN_ID = PFM_CA_IDEA_PLAN.PLAN_ID LEFT OUTER JOIN pfm_ca_financials pfm_ca_financials ON PFM_INVESTMENTS.ID = PFM_CA_FINANCIALS.ID LEFT OUTER JOIN pfm_ca_npiofinproperties pfm_ca_npiofinproperties ON PFM_INVESTMENTS.ID = PFM_CA_NPIOFINPROPERTIES.ID LEFT OUTER JOIN pfm_baseline_details BASEREC ON PFM_INVESTMENTS.ID = BASEREC.ID LEFT OUTER JOIN pfm_ev_history EVREC ON PFM_INVESTMENTS.ID = EVREC.ID LEFT OUTER JOIN pfm_portfolio_ranking_v pfm_portfolio_ranking_v ON PFM_PORTFOLIO_RANKING_V.INSTANCE_ID = PFM_INVESTMENTS.ID AND PFM_PORTFOLIO_RANKING_V.CONTEXT_ID = PFM_INVESTMENTS.PORTFOLIO_ID   JOIN odf_ca_pfm_investment odf_ca_pfm_investment ON odf_ca_pfm_investment.id=pfm_investments.id JOIN (select   'x' pmd_analytical_partition_by, pfm_portfolios.id odf_pk, pfm_portfolios.BENEFITS_CURVE as benefits_curve, (NVL(PFM_PORTFOLIOS.CAPITAL_COST_TARGET,0)+NVL(PFM_PORTFOLIOS.OPERATING_COST_TARGET,0)) as total_cost_target, (NVL(PFM_PORTFOLIOS.CAPITAL_COST_TARGET,0)) as capital_cost_target, (NVL(PFM_PORTFOLIOS.OPERATING_COST_TARGET,0)) as operating_cost_tgt, pfm_portfolios.OPERATING_COST_CURVE as operating_cost_curve, odf_ca_pfm_portfolio.odf_period_type as odf_period_type, (NVL(PFM_PORTFOLIOS.BENEFITS_TARGET,0)) as benefits_target, pfm_portfolios.CURRENCY_CODE as currency_code, odf_ca_pfm_portfolio.odf_period_start as odf_period_start, pfm_portfolios.TOTAL_COST_CURVE as total_cost_curve, pfm_portfolios.START_DATE as start_date, pfm_portfolios.IS_ACTIVE as is_active, pfm_portfolios.RESOURCES_CURVE as resources_curve, (NVL(PFM_PORTFOLIOS.RESOURCES_TARGET,0)) as resources_target, pfm_portfolios.FINISH_DATE as finish_date, pfm_portfolios.NAME as name, pfm_portfolios.CODE as code, odf_ca_pfm_portfolio.odf_period_end as odf_period_end, pfm_portfolios.CAPACITY_UNIT_TYPE as cap_unit_type, pfm_portfolios.CAPITAL_COST_CURVE as capital_cost_curve, odf_ca_pfm_portfolio.odf_entity_code as odf_entity_code from pfm_portfolios pfm_portfolios JOIN odf_ca_pfm_portfolio odf_ca_pfm_portfolio ON odf_ca_pfm_portfolio.id=pfm_portfolios.id  where 1 = 1)  portfolio_id ON portfolio_id.odf_pk=pfm_investments.PORTFOLIO_ID  where 1 = 1 AND PFM_INVESTMENTS_PLAN.PLAN_ID IS NOT NULL</text>
  </QueryResult>
</ClarityDBViewQuery>
