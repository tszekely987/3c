<ClarityDBViewQuery>
  <QueryResult code="DWH_IDEA_V">
    <indexes/>
    <text_length>3300</text_length>
    <text>select inv_investments.id odf_pk, INV_IDEAS.ID as investment_key, inv_ideas.BENEFIT_DESC as benefit_description, COP_CALC_FINISH_FCT(INV_IDEAS.BREAKEVEN_DATE) as breakeven_date, inv_ideas.BUS_UNIT as business_unit, CMN_DATE_TRUNC_FCT(INV_IDEAS.CONVERSION_DATE) as conversion_date, inv_ideas.DEPENDENCIES as dependencies, CMN_DATE_TRUNC_FCT(INV_IDEAS.EST_START_DATE) as estimated_start_date, COP_CALC_FINISH_FCT(INV_IDEAS.EST_FINISH_DATE) as estimated_finish_date, inv_ideas.EST_TYPE as idea_estimate_type_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'IDEAS_EST_TYPE' and rownum = 1 and LOOKUP_ENUM = inv_ideas.EST_TYPE) as est_type_caption, inv_ideas.GENERAL_NOTES as general_notes, inv_ideas.PRIORITY as idea_priority_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'IDEAS_PRIORITY' and rownum = 1 and LOOKUP_ENUM = inv_ideas.PRIORITY) as ideapriority_caption, inv_ideas.IMPACT as impact, NVL(INITIATOR.ID, 0) as requestor_key, 
        INITIATOR.FULL_NAME
      initiator_id_caption, NVL(TGT_MANAGER.ID, 0) as target_manager_key, 
        TGT_MANAGER.FULL_NAME
      target_manager_id_caption, inv_ideas.RISKS as risks, INV_INVESTMENTS.CREATED_DATE as clarity_created_date, INV_INVESTMENTS.LAST_UPDATED_DATE as clarity_updated_date, (  select id from srm_resources where id = odf_ca_idea.obj_business_owner )  as business_owner_key, (  select full_name from srm_resources where id = odf_ca_idea.obj_business_owner ) obj_business_owner_caption, odf_ca_idea.obj_fast_track as is_fast_track, odf_ca_idea.obj_objective as objective, (  select idea_prj_category_key from dwh_lkp_idea_project_cat_v where idea_prj_category_key = odf_ca_idea.obj_request_category and language_code = dataw_context.language_code  )  as idea_prj_category_key, (  select idea_prj_category from dwh_lkp_idea_project_cat_v where idea_prj_category_key = odf_ca_idea.obj_request_category and language_code = dataw_context.language_code  ) obj_request_category_caption, odf_ca_idea.obj_request_type as idea_prj_type_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'OBJ_IDEA_PROJECT_TYPE' and rownum = 1 and LOOKUP_CODE = odf_ca_idea.obj_request_type) as obj_request_type_caption, dataw_context.language_code, dataw_context.id language_id from inv_investments inv_investments inner join cmn_languages dataw_context on dataw_context.id = dataw_context.id  JOIN pac_mnt_projects PAC_MNT_PROJECTS ON PAC_MNT_PROJECTS.id=inv_investments.id JOIN inv_ideas inv_ideas ON inv_ideas.id=inv_investments.id join odf_object_instance_mapping oim1 on inv_investments.id = oim1.primary_object_instance_id  and oim1.primary_object_instance_code='idea' join fin_financials fin_financials on oim1.secondary_object_instance_id = fin_financials.id and oim1.secondary_object_instance_code='financials' JOIN odf_ca_financials odf_ca_financials ON odf_ca_financials.id=FIN_FINANCIALS.id JOIN odf_ca_idea odf_ca_idea ON odf_ca_idea.id=inv_investments.id LEFT OUTER JOIN srm_resources INITIATOR ON INV_IDEAS.INITIATOR_ID = INITIATOR.USER_ID LEFT OUTER JOIN srm_resources TGT_MANAGER ON INV_IDEAS.TARGET_MANAGER_ID = TGT_MANAGER.USER_ID  where 1 = 1 and dataw_context.is_dw_enabled=1</text>
  </QueryResult>
</ClarityDBViewQuery>
