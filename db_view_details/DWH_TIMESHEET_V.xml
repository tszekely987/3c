<ClarityDBViewQuery>
  <QueryResult code="DWH_TIMESHEET_V">
    <indexes/>
    <text_length>1759</text_length>
    <text>select prtimesheet.prid odf_pk, PRTIMESHEET.PRID as timesheet_key, PRTIMESHEET.PRID as clarity_timesheet_key, NVL(PRTIMESHEET.PRTIMEPERIODID, 0) as time_period_key, CMN_DATE_TRUNC_FCT( DWH_TIMESHEET_TIMEPERIOD_V.PRSTART ) as period_start_date, COP_CALC_FINISH_FCT( DWH_TIMESHEET_TIMEPERIOD_V.PRFINISH ) as period_finish_date, NVL(PRTIMESHEET.PRRESOURCEID, 0) as resource_key, 
        SRM_RESOURCES.FULL_NAME
      prresourceid_caption, NVL(PRTIMESHEET.PRSTATUS, 0) as timesheet_status_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'TIMESHEET_STATUS' and rownum = 1 and LOOKUP_ENUM = NVL(PRTIMESHEET.PRSTATUS, 0)) as prstatus_caption, NVL(SRMRESOURCESUB.ID,0) as submitted_by_key, 
        SRMRESOURCESUB.full_name
      prsubmittedby_caption, NVL(SRMRESOURCEAPP.ID,0) as approved_by_key, 
        SRMRESOURCEAPP.full_name
      prapprovedby_caption, NVL(PRTIMESHEET.PRADJUSTEDID, 0) as adjustment_key, NVL(PRTIMESHEET.PRISADJUSTMENT,0) as is_adjustment, CMN_DATE_TRUNC_FCT(PRTIMESHEET.POSTED_TIME) as posted_date, prtimesheet.PRMODTIME as clarity_updated_date, dataw_context.language_code, dataw_context.id language_id from prtimesheet prtimesheet LEFT OUTER JOIN srm_resources SRMRESOURCESUB ON PRTIMESHEET.PRSUBMITTEDBY = SRMRESOURCESUB.USER_ID LEFT OUTER JOIN srm_resources SRMRESOURCEAPP ON PRTIMESHEET.PRAPPROVEDBY = SRMRESOURCEAPP.USER_ID, dwh_timesheet_timeperiod_v dwh_timesheet_timeperiod_v, srm_resources srm_resources LEFT OUTER JOIN SRM_RESOURCES MANAGER ON MANAGER.USER_ID=SRM_RESOURCES.MANAGER_ID, cmn_languages dataw_context  where 1 = 1 and prtimesheet.prtimeperiodid = dwh_timesheet_timeperiod_v.prid and prtimesheet.prresourceid = srm_resources.id and dataw_context.is_dw_enabled=1</text>
  </QueryResult>
</ClarityDBViewQuery>
