<ClarityDBViewQuery>
  <QueryResult code="DWH_X_INV_TASK_TODO_FACTS_V">
    <indexes/>
    <text_length>481</text_length>
    <text>SELECT assoc.assoc_instance_id task_key,
       SUM(CASE WHEN t.completed = 0 THEN 1 ELSE 0 END) todo_open_count, 
       SUM(CASE WHEN t.completed = 0 THEN 0 ELSE 1 END) todo_completed_count,
       COUNT(1) todo_total_count,
       MAX(t.last_updated_date) last_updated_date
FROM   oba_todos t
       JOIN oba_associations assoc ON  t.id = assoc.src_instance_id
WHERE  assoc.src_object_alias = 'obaTodos'
AND    assoc.assoc_object_alias = 'tasks'
GROUP BY assoc.assoc_instance_id</text>
  </QueryResult>
</ClarityDBViewQuery>
