<ClarityDBViewQuery>
  <QueryResult code="NTD_MESSAGE_HEADERS_V">
    <indexes/>
    <text_length>1989</text_length>
    <text>SELECT 
  NTD_MESSAGES.MESSAGE_ID,
  NTD_MESSAGES.AUTHOR_ID,
  NTD_MESSAGES.TITLE,
  NTD_MESSAGES.DATE_POSTED,
  NTD_MESSAGES.REPLY_COUNT,
  NTD_MESSAGES.LAST_POST_DATE,
  NTD_MESSAGES.MESSAGE_LEVEL,
  NTD_MESSAGES.ATTACHMENT_ID ATTACHMENT_FOLDER_ID,
  NTD_MESSAGES.GROUP_ID_OWNERS,
  U2.FIRST_NAME,
  U2.LAST_NAME,
  ASSGNPERM.PRINCIPAL_ID USER_ID,
  NTD_MESSAGES.ALL_PARENT_PARTICIPANTS,
  NTD_MESSAGES.TOPIC_ID,
  NTD_MESSAGES.PARENT_MESSAGE_ID
FROM
  CMN_SEC_USERS U2,
  CMN_SEC_USERS U1,
  NTD_MESSAGES,
  CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE
         NTD_MESSAGES.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID IN (1,5)
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'USER'
AND      ASSGNPERM.PRINCIPAL_ID = U1.ID
AND      NTD_MESSAGES.AUTHOR_ID = U2.ID
UNION
SELECT 
  NTD_MESSAGES.MESSAGE_ID,
  NTD_MESSAGES.AUTHOR_ID,
  NTD_MESSAGES.TITLE,
  NTD_MESSAGES.DATE_POSTED,
  NTD_MESSAGES.REPLY_COUNT,
  NTD_MESSAGES.LAST_POST_DATE,
  NTD_MESSAGES.MESSAGE_LEVEL,
  NTD_MESSAGES.ATTACHMENT_ID ATTACHMENT_FOLDER_ID,
  NTD_MESSAGES.GROUP_ID_OWNERS,
  U2.FIRST_NAME,
  U2.LAST_NAME,
  UG.USER_ID USER_ID,
  NTD_MESSAGES.ALL_PARENT_PARTICIPANTS,
  NTD_MESSAGES.TOPIC_ID,
  NTD_MESSAGES.PARENT_MESSAGE_ID
FROM     CMN_SEC_USERS U2,
         CMN_SEC_USERS U1,
     	 CMN_SEC_USER_GROUPS UG,
         CMN_SEC_GROUPS PARENT_GROUP,
         CMN_SEC_GROUPS G,
	 CMN_SEC_GROUP_FLAT_HIERS H,
         NTD_MESSAGES,
         CMN_SEC_ASSGND_OBJ_PERM ASSGNPERM
WHERE    NTD_MESSAGES.ALL_PARENT_PARTICIPANTS = ASSGNPERM.OBJECT_INSTANCE_ID
AND      ASSGNPERM.OBJECT_ID = 401
AND      ASSGNPERM.PERMISSION_ID IN (1, 5)
AND	 ASSGNPERM.PRINCIPAL_TYPE = 'GROUP'
AND	 ASSGNPERM.PRINCIPAL_ID = H.PARENT_GROUP_ID
AND      UG.GROUP_ID = H.GROUP_ID
AND      H.GROUP_ID = G.ID
AND      G.IS_ACTIVE = 1
AND      H.PARENT_GROUP_ID = PARENT_GROUP.ID
AND      PARENT_GROUP.IS_ACTIVE = 1
AND      UG.USER_ID = U1.ID
AND      NTD_MESSAGES.AUTHOR_ID = U2.ID</text>
  </QueryResult>
</ClarityDBViewQuery>
