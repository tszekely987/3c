<ClarityDBViewQuery>
  <QueryResult code="ODF_PFM_INVESTMENT_CALCS_V2">
    <indexes/>
    <text_length>2448</text_length>
    <text>select   'x' pmd_analytical_partition_by, pfm_investments.id odf_pk, ((CASE WHEN (EVREC.ITD_BCWS*1.00)=0 THEN NULL ELSE ((EVREC.ITD_BCWP*1.00)-(EVREC.ITD_BCWS*1.00))/(EVREC.ITD_BCWS*1.00) END )*(100.0*1.00)) as p_obj_ev_sv_pct, ((CASE WHEN (EVREC.ITD_BCWP*1.00)=0 THEN NULL ELSE ((EVREC.ITD_BCWP*1.00)-(EVREC.ITD_ACWP*1.00))/(EVREC.ITD_BCWP*1.00) END )*(100.0*1.00)) as p_obj_ev_cv_pct, (((NVL(PFM_INVESTMENTS.labor_eacsum,0)/3600)/(select hours_per_day from prj_hours_per_day_v)*1.00)-((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00)) as p_obj_effort_amt_var, (CASE WHEN (nvl2((PFM_CA_INV.obj_align_factor1*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor2*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor3*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor4*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor5*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor6*1),1,0))=0 THEN NULL ELSE (nvl((PFM_CA_INV.obj_align_factor1*1),0)+nvl((PFM_CA_INV.obj_align_factor2*1),0)+nvl((PFM_CA_INV.obj_align_factor3*1),0)+nvl((PFM_CA_INV.obj_align_factor4*1),0)+nvl((PFM_CA_INV.obj_align_factor5*1),0)+nvl((PFM_CA_INV.obj_align_factor6*1),0))/(nvl2((PFM_CA_INV.obj_align_factor1*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor2*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor3*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor4*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor5*1),1,0)+nvl2((PFM_CA_INV.obj_align_factor6*1),1,0)) END ) as obj_alignment, pfm_investments.PORTFOLIO_ID as portfolio_id, (((EVREC.ETC*1.00)+(EVREC.ITD_ACWP*1.00))-(EVREC.BAC*1.00)) as p_obj_cost_amt_var, (CMN_DATE_TIME_DIFF_FCT('Day',PFM_INVESTMENTS.schedule_finish,BASEREC.FINISH_DATE)) as p_obj_schedule_var, ((CASE WHEN ((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00)=0 THEN NULL ELSE (((NVL(PFM_INVESTMENTS.labor_eacsum,0)/3600)/(select hours_per_day from prj_hours_per_day_v)*1.00)-((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00))/((BASEREC.USAGE_SUM / 3600) / PRJ_HPD_FACTOR_FCT()*1.00) END )*(100.0*1.00)) as p_obj_effort_var, ((CASE WHEN (EVREC.BAC*1.00)=0 THEN NULL ELSE (((EVREC.ETC*1.00)+(EVREC.ITD_ACWP*1.00))-(EVREC.BAC*1.00))/(EVREC.BAC*1.00) END )*(100.0*1.00)) as p_obj_cost_pct_var, pfm_investments.INVESTMENT_ID as investment_id from pfm_investments pfm_investments LEFT OUTER JOIN pfm_ca_inv pfm_ca_inv ON PFM_INVESTMENTS.ID = PFM_CA_INV.ID LEFT OUTER JOIN pfm_baseline_details BASEREC ON PFM_INVESTMENTS.ID = BASEREC.ID LEFT OUTER JOIN pfm_ev_history EVREC ON PFM_INVESTMENTS.ID = EVREC.ID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
