<ClarityDBViewQuery>
  <QueryResult code="CAL_ACTION_ITEMS_QLIST_V">
    <indexes/>
    <text_length>3727</text_length>
    <text>(SELECT AITEMS.ID,
    AITEMS.SUBJECT SUBJECT,
    AITEMS.DESCRIPTION DESCRIPTION,
    AITEMS.OBJECT_TYPE OBJECT_TYPE,
    AI_LOOKUP.NAME OBJECT_TYPE_NAME,
    AI_LOOKUP.LANGUAGE_CODE LANGUAGE_CODE,
    AITEMS.OBJECT_ID OBJECT_ID,
    AITEMS.PROCESS_HANDLER_ID,
    AITEMS.MULTIPLE_ASSIGNEE,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEES.UPCOMING_DATE
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES
        WHERE ASSIGNEES.CAL_ACTION_ITEM_ID = AITEMS.ID
        )
      ELSE AITEMS.DUE_DATE
    END DUE_DATE,
    AITEMS.IS_RECURRING,
    AITEMS.PRIORITY_CODE PRIORITY_CODE,
    AITEMS.CREATED_BY OWNER_ID,
    USER_OWNER.FIRST_NAME OWNER_FIRST_NAME,
    USER_OWNER.LAST_NAME OWNER_LAST_NAME,
    USER_OWNER.USER_NAME OWNER_USER_NAME,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEES.ID
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        )
      ELSE NULL
    END ASSIGNEE_ID,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEES.ASSIGNEE_ID
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        )
      ELSE NULL
    END ASSIGNEE_USER_ID,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT USER_ASSIGNEE.FIRST_NAME
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES,
          CMN_SEC_USERS USER_ASSIGNEE
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        AND USER_ASSIGNEE.ID     = ASSIGNEES.ASSIGNEE_ID
        )
      ELSE NULL
    END ASSIGNEE_FIRST_NAME,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT USER_ASSIGNEE.LAST_NAME
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES,
          CMN_SEC_USERS USER_ASSIGNEE
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        AND USER_ASSIGNEE.ID     = ASSIGNEES.ASSIGNEE_ID
        )
      ELSE NULL
    END ASSIGNEE_LAST_NAME,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEES.STATUS_CODE
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        )
	  ELSE
        (SELECT
          CASE
            WHEN 1 =
              (SELECT COUNT (DISTINCT STATUS_CODE ) COUNT
              FROM CAL_ACTION_ITEM_ASSIGNEES
              WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
              )
            THEN
              (SELECT DISTINCT STATUS_CODE
              FROM CAL_ACTION_ITEM_ASSIGNEES
              WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
              )
            ELSE 'GROUP'
          END SCODE
        FROM DUAL
        )
    END STATUS_CODE,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEE_LOOKUP.NAME
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES,
          CMN_LOOKUPS_V ASSIGNEE_LOOKUP
        WHERE ASSIGNEE_LOOKUP.LOOKUP_CODE = ASSIGNEES.STATUS_CODE
        AND ASSIGNEE_LOOKUP.LANGUAGE_CODE = AI_LOOKUP.LANGUAGE_CODE
        AND ASSIGNEE_LOOKUP.LOOKUP_TYPE   = 'CAL_EVENT_STATUS'
        AND CAL_ACTION_ITEM_ID            = AITEMS.ID
        )
      ELSE NULL
    END STATUS,
    CASE
      WHEN AITEMS.MULTIPLE_ASSIGNEE=0
      THEN
        (SELECT ASSIGNEES.IS_PROXY
        FROM CAL_ACTION_ITEM_ASSIGNEES ASSIGNEES
        WHERE CAL_ACTION_ITEM_ID = AITEMS.ID
        )
      ELSE 0
    END IS_PROXY,
    AITEMS.SUB_OBJECT_ID SUB_OBJECT_ID,
    AITEMS.SUB_OBJECT_TYPE SUB_OBJECT_TYPE,
    AITEMS.AI_DEF_TYPE,
    AITEMS.AI_DEF_ID
  FROM CAL_ACTION_ITEMS AITEMS,
    CMN_SEC_USERS USER_OWNER,
    CMN_LOOKUPS_V AI_LOOKUP
  WHERE USER_OWNER.ID       = AITEMS.CREATED_BY
  AND AI_LOOKUP.LOOKUP_CODE = NVL(AITEMS.SUB_OBJECT_TYPE,AITEMS.OBJECT_TYPE)
  AND AI_LOOKUP.LOOKUP_TYPE = 'CAL_OBJECT_TYPE'
  )</text>
  </QueryResult>
</ClarityDBViewQuery>
