<ClarityDBViewQuery>
  <QueryResult code="DWH_CHANGE_V">
    <indexes/>
    <text_length>4547</text_length>
    <text>select rim_risks_and_issues.id odf_pk, RIM_RISKS_AND_ISSUES.ID as change_request_key, RIM_RISKS_AND_ISSUES.ID as clarity_change_request_key, rim_risks_and_issues.PK_ID as investment_key, rim_risks_and_issues.RIM_RISK_ISSUE_CODE as change_request_id, rim_risks_and_issues.NAME as change_request_name, rim_risks_and_issues.DESCRIPTION as description, NVL(OWNERRES.ID,0) as owner_key, 
       OWNERRES.FULL_NAME
      assigned_to_caption, NVL(APPRRES.ID,0) as approved_by_key, 
       APPRRES.FULL_NAME
      approved_by_caption, rim_risks_and_issues.CATEGORY_TYPE_CODE as rim_category_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_CATEGORY_TYPE' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.CATEGORY_TYPE_CODE) as category_type_caption, rim_risks_and_issues.PRIORITY_CODE as rim_priority_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_PRIORITY' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.PRIORITY_CODE) as priority_code_caption, rim_risks_and_issues.STATUS_CODE as rim_status_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_STATUS' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.STATUS_CODE) as status_code_caption, CMN_DATE_TRUNC_FCT(RIM_CHANGE_REQUESTS.ASSESSMENT_DATE) as assessment_date, NVL(ASSESRRES.ID,0) as assessor_key, 
       ASSESRRES.FULL_NAME
      assessor_caption, CMN_DATE_TRUNC_FCT(RIM_CHANGE_REQUESTS.APPROVED_DATE) as approved_date, rim_change_requests.BENEFITS as benefits, rim_change_requests.EFFECT_ON_COST as change_in_cost, rim_change_requests.EFFECT_ON_RESOURCES as change_in_resources, rim_change_requests.EFFECT_ON_SCHEDULE as change_in_schedule, CMN_DATE_TRUNC_FCT(RIM_CHANGE_REQUESTS.CLOSURE_DATE) as close_date, rim_change_requests.IMPACT_ON_BASELINE as impact_on_baseline, rim_risks_and_issues.IMPACT_DESCRIPTION as impact_on_projects, rim_risks_and_issues.ASSUMPTIONS as reasons, CMN_DATE_TRUNC_FCT(RIM_CHANGE_REQUESTS.REVIEW_DATE) as next_review_date, CMN_DATE_TRUNC_FCT(RIM_RISKS_AND_ISSUES.TARGET_RESOLUTION_DATE) as expected_close_date, INVESTMENTS.CURRENCY_CODE as currency_code, CREATED.ID as created_by_key, 
        CREATED.FULL_NAME
      dwh_created_by_caption, UPDATED.ID as updated_by_key, 
        UPDATED.FULL_NAME
      dwh_updated_by_caption, RIM_RISKS_AND_ISSUES.CREATED_DATE as clarity_created_date, RIM_RISKS_AND_ISSUES.LAST_UPDATED_DATE as clarity_updated_date, NVL((SELECT R.ID FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'RISK'), 0) as originating_risk_key, 
        (SELECT R.NAME FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
        AND R.TYPE_CODE = 'RISK')
      dwh_orig_risk_id_caption, (SELECT R.RIM_RISK_ISSUE_CODE FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'RISK') as originating_risk_id, NVL((SELECT R.ID FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'ISSUE'), 0) as originating_issue_key, 
        (SELECT R.NAME FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
        AND R.TYPE_CODE = 'ISSUE')
      dwh_orig_issue_id_caption, (SELECT R.RIM_RISK_ISSUE_CODE FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'ISSUE') as originating_issue_id, odf_ca_change.odmd_rpting as odmd_rpting, dataw_context.language_code, dataw_context.id language_id from rim_risks_and_issues rim_risks_and_issues inner join cmn_languages dataw_context on dataw_context.id = dataw_context.id  JOIN rim_change_requests rim_change_requests ON rim_change_requests.id=rim_risks_and_issues.id JOIN odf_ca_change odf_ca_change ON odf_ca_change.id=rim_risks_and_issues.id LEFT OUTER JOIN srm_resources OWNERRES ON RIM_RISKS_AND_ISSUES.assigned_to=OWNERRES.USER_ID LEFT OUTER JOIN srm_resources APPRRES ON RIM_CHANGE_REQUESTS.approved_by=APPRRES.USER_ID LEFT OUTER JOIN srm_resources ASSESRRES ON RIM_CHANGE_REQUESTS.assessor=ASSESRRES.USER_ID LEFT OUTER JOIN inv_investments INVESTMENTS ON RIM_RISKS_AND_ISSUES.pk_id=INVESTMENTS.ID JOIN srm_resources CREATED ON CREATED.user_id=rim_risks_and_issues.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=rim_risks_and_issues.last_updated_by  where 1 = 1
       and rim_risks_and_issues.type_code = 'CHANGE' and dataw_context.is_dw_enabled=1</text>
  </QueryResult>
</ClarityDBViewQuery>
