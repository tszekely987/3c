<ClarityDBViewQuery>
  <QueryResult code="ODF_OBJECT_CUSTOM_VIEWS_V">
    <indexes/>
    <text_length>4759</text_length>
    <text>( SELECT -- property and filter views
    W.ID ID,
    W.ID || '::' || W.VIEW_TYPE ID_VIEW_TYPE,
    VNLS.NAME VIEW_NAME,
    W.CODE VIEW_CODE,
    ONLS.NAME OBJECT_NAME,
    W.OBJECT_CODE OBJECT_CODE,
    O.ID OBJECT_ID,
    CASE
      WHEN W.VIEW_TYPE = 'property' THEN 'Property'
      WHEN W.VIEW_TYPE = 'filter' THEN 'Filter'
      ELSE NULL
    END VIEW_TYPE,
    CASE
      WHEN W.VIEW_SUBTYPE = 'update' THEN 'Edit'
      WHEN W.VIEW_SUBTYPE = 'create' THEN 'Create'
      ELSE NULL
    END VIEW_SUBTYPE,
    'ODF_VIEWS' TABLE_NAME,
    O.COMPONENT COMPONENT,
    O.IS_CUSTOM IS_CUSTOM,
    ONLS.LANGUAGE_CODE LANGUAGE_CODE
  FROM ODF_VIEWS W, ODF_OBJECTS O, CMN_CAPTIONS_NLS VNLS, CMN_CAPTIONS_NLS ONLS
  WHERE O.CODE          = W.OBJECT_CODE
    AND W.PARTITION_CODE  = 'NIKU.ROOT'
    AND O.IS_CUSTOMIZABLE = 1
    AND ( ( W.IS_SYSTEM    = 1 AND W.VIEW_TYPE = 'property') OR W.VIEW_TYPE = 'filter')
    AND ( W.PRINCIPAL_TYPE ='ADMINISTRATOR'
          OR W.ID = ( SELECT MAX(ID)
                      FROM ODF_VIEWS
                      WHERE OBJECT_CODE   =W.OBJECT_CODE
                      AND PARTITION_CODE  =W.PARTITION_CODE
                      AND PARTITION_CODE != 'NIKU.ROOT'
                      AND VIEW_TYPE       ='filter'
                      AND PRINCIPAL_TYPE  ='USER'
                      AND VIEW_SUBTYPE   IS NULL
                      )
          AND NOT EXISTS ( SELECT 'x'
                          FROM ODF_VIEWS
                          WHERE OBJECT_CODE   =W.OBJECT_CODE
                          AND PARTITION_CODE  =W.PARTITION_CODE
                          AND PARTITION_CODE != 'NIKU.ROOT'
                          AND VIEW_TYPE       ='filter'
                          AND PRINCIPAL_TYPE  ='ADMINISTRATOR'
                          AND VIEW_SUBTYPE   IS NULL
                          ))
    AND ( W.VIEW_TYPE = 'property' AND W.VIEW_SUBTYPE IN ('create','update') OR (W.VIEW_TYPE = 'filter' AND W.VIEW_SUBTYPE IS NULL))
    AND VNLS.TABLE_NAME = 'ODF_VIEWS' AND VNLS.PK_ID = W.ID
    AND ONLS.TABLE_NAME = 'ODF_OBJECTS' AND ONLS.PK_ID = O.ID
	  AND ONLS.LANGUAGE_CODE = VNLS.LANGUAGE_CODE

  UNION

  -- list views that are configured in studio
  SELECT
    G.ID ID,
    G.ID || '::' || 'list' ID_VIEW_TYPE,
    VNLS.NAME VIEW_NAME,
    G.CODE VIEW_CODE,
    ONLS.NAME OBJECT_NAME,
    O.CODE OBJECT_CODE,
    O.ID OBJECT_ID,
    'List' VIEW_TYPE,
    null VIEW_SUBTYPE,
    'CMN_GRIDS' TABLE_NAME,
    O.COMPONENT COMPONENT,
    O.IS_CUSTOM IS_CUSTOM,
    ONLS.LANGUAGE_CODE LANGUAGE_CODE
  FROM CMN_GRIDS G, ODF_OBJECTS O, CMN_CAPTIONS_NLS VNLS, CMN_CAPTIONS_NLS ONLS
  WHERE G.PRINCIPAL_TYPE  = 'SYSTEM'
          AND UPPER(G.DAL_TYPE) = 'OBJECT'
          AND O.IS_CUSTOMIZABLE = 1
          AND G.DAL_CODE = O.CODE
          AND PORTLET_ID IS NULL
          AND G.DAL_PARTITION_CODE = 'NIKU.ROOT'
          AND VNLS.TABLE_NAME = 'CMN_GRIDS' AND VNLS.PK_ID = G.ID
          AND ONLS.TABLE_NAME = 'ODF_OBJECTS' AND ONLS.PK_ID = O.ID
	        AND ONLS.LANGUAGE_CODE = VNLS.LANGUAGE_CODE

	UNION
	SELECT
    G.ID ID,
    G.ID || '::' || 'slist' ID_VIEW_TYPE,
    G.CODE VIEW_NAME,
    G.CODE  VIEW_CODE,
    ONLS.NAME OBJECT_NAME,
    G.FILTERCODE OBJECT_CODE,
    O.ID OBJECT_ID,
    'List' VIEW_TYPE,
    null VIEW_SUBTYPE,
    'ODF_CVIEW_RELEASES' TABLE_NAME,
    O.COMPONENT COMPONENT,
    O.IS_CUSTOM IS_CUSTOM,
    ONLS.LANGUAGE_CODE LANGUAGE_CODE
  FROM ODF_CVIEW_RELEASES G, ODF_OBJECTS O, CMN_CAPTIONS_NLS ONLS
    WHERE O.CODE = G.FILTERCODE
      AND O.IS_CUSTOMIZABLE = 1
      AND O.IS_CUSTOM = 0
      AND ONLS.TABLE_NAME = 'ODF_OBJECTS' AND ONLS.PK_ID = O.ID
      AND NOT EXISTS ( SELECT 'A' FROM CMN_GRIDS WHERE G.CODE = CODE  AND PRINCIPAL_TYPE = 'SYSTEM' AND DAL_PARTITION_CODE = 'NIKU.ROOT' )
  UNION
      SELECT G.ID,
  G.ID  || '::'  || 'list' ID_VIEW_TYPE,
  VNLS.NAME VIEW_NAME,
  G.CODE VIEW_CODE,
  ONLS.NAME OBJECT_NAME,
  G.Dal_Code Object_Code,
  O.ID OBJECT_ID,
  'List' VIEW_TYPE,
  NULL VIEW_SUBTYPE,
  VNLS.TABLE_NAME TABLE_NAME,
  O.Component Component,
  O.IS_CUSTOM IS_CUSTOM,
  ONLS.Language_Code Language_Code
FROM CMN_GRIDS G,
  ODF_OBJECTS O,
  CMN_CAPTIONS_NLS VNLS,
  CMN_CAPTIONS_NLS ONLS
WHERE O.CODE =
  ( SELECT DISTINCT FILTERCODE
  FROM ODF_CVIEW_RELEASES
  WHERE NLS_UPPER(CODE) = NLS_UPPER(G.CODE)
  )
AND G.PRINCIPAL_TYPE  = 'SYSTEM'
AND G.PORTLET_ID     IS NULL
AND O.IS_CUSTOMIZABLE = 1
AND O.IS_CUSTOM       = 0
AND VNLS.PK_ID        = G.ID
AND Onls.Table_Name   = 'ODF_OBJECTS'
AND VNLS.TABLE_NAME   = 'CMN_GRIDS'
AND ONLS.PK_ID       IN
  (SELECT ID
  FROM ODF_OBJECTS
  WHERE CODE =
    (SELECT DISTINCT FILTERCODE
    FROM ODF_CVIEW_RELEASES
    WHERE NLS_UPPER(CODE) = NLS_UPPER(G.CODE)
    )
  )
AND Onls.Language_Code = Vnls.Language_Code
  )</text>
  </QueryResult>
</ClarityDBViewQuery>
