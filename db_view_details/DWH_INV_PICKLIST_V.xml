<ClarityDBViewQuery>
  <QueryResult code="DWH_INV_PICKLIST_V">
    <indexes/>
    <text_length>1416</text_length>
    <text>SELECT PLC.OBJECT_CODE || TO_CHAR(PLD.ID) || L.LOOKUP_CODE PICKLIST_KEY,
       PLC.ID PICKLIST_CONTEXT_KEY,
       PLC.OBJECT_CODE OBJECT_CODE_KEY,
       O.NAME OBJECT_CODE,
       PLC.IS_ACTIVE IS_ACTIVE,
	   PLD.ID PICKLIST_DEF_KEY,
	   PLD.NAME PICKLIST,
	   LT.ID LOOKUP_TYPE_KEY,
	   LT.NAME LOOKUP_TYPE,
       L.LOOKUP_CODE LOOKUP_CODE_KEY,
	   L.NAME LOOKUP_CODE,
	   LANG.LANGUAGE_CODE_KEY,
	   LANG.LANGUAGE_CODE,
	   GREATEST(PLC.LAST_UPDATED_DATE, PLD.LAST_UPDATED_DATE, L.LAST_UPDATED_DATE) CLARITY_UPDATED_DATE,
	   GREATEST(PLC.CREATED_DATE, PLD.CREATED_DATE, L.CREATED_DATE) CLARITY_CREATED_DATE
FROM   ODF_PICKLIST_CONTEXTS PLC
       INNER JOIN ODF_OBJECTS_V O ON PLC.OBJECT_CODE = O.CODE
       INNER JOIN ODF_PICKLIST_DEFS PLD ON PLC.ID = PLD.CONTEXT_ID
	   INNER JOIN CMN_LOOKUP_TYPES_V LT ON PLD.LOOKUP_TYPE = LT.LOOKUP_TYPE 
	   INNER JOIN CMN_LOOKUPS_V L ON LT.LOOKUP_TYPE = L.LOOKUP_TYPE
	   INNER JOIN (SELECT DISTINCT L_1.ID AS LANGUAGE_CODE_KEY,
                                   L_1.LANGUAGE_CODE
                   FROM   CMN_LANGUAGES L_1
                   WHERE  L_1.IS_DW_ENABLED = 1) LANG ON 1=1
WHERE  LANG.LANGUAGE_CODE = LT.LANGUAGE_CODE 
AND    LANG.LANGUAGE_CODE = L.LANGUAGE_CODE
AND    LANG.LANGUAGE_CODE = O.LANGUAGE_CODE
AND   (PLC.OBJECT_CODE IN ('project','idea','task')
OR     OBJECT_CODE IN (SELECT CODE FROM ODF_OBJECTS WHERE TEMPLATE_EXTENSION = 'inv_extension'))</text>
  </QueryResult>
</ClarityDBViewQuery>
