<ClarityDBViewQuery>
  <QueryResult code="DWH_PPM_FISCAL_SLICE_FACTS_V">
    <indexes/>
    <text_length>2381</text_length>
    <text>SELECT S.SLICE_REQUEST_KEY,
       S.OBJECT_KEY,
       S.PERIOD_KEY,
       S.SLICE,
       S.FACT_TYPE,
       S.IS_BASELINE,
       S.CREATED_DATE
FROM  (WITH SLICE_REQUESTS AS
            (SELECT id slice_request_key,
                    CASE WHEN request_name IN ('assignment::practcurve::dwh_fiscal',
                                               'assignment::prestcurve::dwh_fiscal',
                                               'baseline::current_assignment_usage::dwh_fiscal',
                                               'baseline::current_assignment_cost::dwh_fiscal',
                                               'assignment::actcost_curve::dwh_fiscal',
                                               'assignment::etccost_curve::dwh_fiscal') THEN 1
                         WHEN request_name IN ('resource::pravailcurve::dwh_fiscal') THEN 2
                         WHEN request_name IN ('team::pralloccurve::dwh_fiscal',
                                               'baseline::current_team_usage::dwh_fiscal',
                                               'baseline::current_team_cost::dwh_fiscal',
                                               'team::hard_curve::dwh_fiscal',
                                               'team::alloccost_curve::dwh_fiscal',
                                               'team::hardallccost_curve::dwh_fiscal') THEN 3
                         ELSE 0 END fact_type,
                    CASE WHEN request_name IN ('baseline::current_assignment_usage::dwh_fiscal',
                                               'baseline::current_assignment_cost::dwh_fiscal',
                                               'baseline::current_team_usage::dwh_fiscal',
                                               'baseline::current_team_cost::dwh_fiscal') THEN 1
                         ELSE 0 END is_baseline
             FROM   prj_blb_slicerequests
             WHERE  is_dwh_request = 1)
             SELECT SR.SLICE_REQUEST_KEY,
                    S.PRJ_OBJECT_ID OBJECT_KEY,
                    S.PERIOD_ID PERIOD_KEY,
                    S.SLICE,
                    SR.FACT_TYPE,
                    SR.IS_BASELINE,
                    S.CREATED_DATE
             FROM   SLICE_REQUESTS SR         
                    INNER JOIN PRJ_FISCAL_BLB_SLICES S ON SR.SLICE_REQUEST_KEY = S.SLICE_REQUEST_ID
		     WHERE  S.SLICE &lt;&gt; 0) S</text>
  </QueryResult>
</ClarityDBViewQuery>
