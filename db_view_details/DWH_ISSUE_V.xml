<ClarityDBViewQuery>
  <QueryResult code="DWH_ISSUE_V">
    <indexes/>
    <text_length>3617</text_length>
    <text>select rim_risks_and_issues.id odf_pk, RIM_RISKS_AND_ISSUES.ID as issue_key, RIM_RISKS_AND_ISSUES.ID as clarity_issue_key, rim_risks_and_issues.PK_ID as investment_key, rim_risks_and_issues.RIM_RISK_ISSUE_CODE as issue_id, rim_risks_and_issues.NAME as issue_name, rim_risks_and_issues.DESCRIPTION as description, NVL(OWNERRES.ID,0) as owner_key, 
        OWNERRES.FULL_NAME
      assigned_to_caption, rim_risks_and_issues.CATEGORY_TYPE_CODE as rim_category_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_CATEGORY_TYPE' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.CATEGORY_TYPE_CODE) as category_type_caption, CMN_DATE_TRUNC_FCT(RIM_RISKS_AND_ISSUES.IMPACT_DATE) as impact_date, rim_risks_and_issues.PRIORITY_CODE as rim_priority_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_PRIORITY' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.PRIORITY_CODE) as priority_code_caption, rim_risks_and_issues.RESOLUTION as resolution, NVL(RESBYRES.ID,0) as resolved_by_key, 
        RESBYRES.FULL_NAME
      resolved_by_caption, CMN_DATE_TRUNC_FCT(RIM_RISKS_AND_ISSUES.RESOLVED_DATE) as resolved_date, rim_risks_and_issues.STATUS_CODE as rim_status_key, (select NAME from cmn_lookups_v where language_code = dataw_context.language_code and lookup_type = 'RIM_STATUS' and rownum = 1 and LOOKUP_CODE = rim_risks_and_issues.STATUS_CODE) as status_code_caption, CMN_DATE_TRUNC_FCT(RIM_RISKS_AND_ISSUES.TARGET_RESOLUTION_DATE) as target_resolution_date, CREATED.ID as created_by_key, 
        CREATED.FULL_NAME
      dwh_created_by_caption, UPDATED.ID as updated_by_key, 
        UPDATED.FULL_NAME
      dwh_updated_by_caption, NVL((SELECT R.ID FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'RISK'), 0) as originating_risk_key, 
        (SELECT R.NAME FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
        AND R.TYPE_CODE = 'RISK')
      dwh_orig_risk_id_caption, (SELECT R.RIM_RISK_ISSUE_CODE FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'RISK') as originating_risk_id, NVL((SELECT R.ID FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'CHANGE'), 0) as originating_change_key, 
        (SELECT R.NAME FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
        AND R.TYPE_CODE = 'CHANGE')
      dwh_orig_change_id_caption, (SELECT R.RIM_RISK_ISSUE_CODE FROM RIM_RISKS_AND_ISSUES R WHERE R.ID=RIM_RISKS_AND_ISSUES.PARENT_RISK_ISSUE_ID
      AND R.TYPE_CODE = 'CHANGE') as originating_change_id, RIM_RISKS_AND_ISSUES.CREATED_DATE as clarity_created_date, RIM_RISKS_AND_ISSUES.LAST_UPDATED_DATE as clarity_updated_date, odf_ca_issue.odmd_rpting as odmd_rpting, dataw_context.language_code, dataw_context.id language_id from rim_risks_and_issues rim_risks_and_issues inner join cmn_languages dataw_context on dataw_context.id = dataw_context.id  JOIN odf_ca_issue odf_ca_issue ON odf_ca_issue.id=rim_risks_and_issues.id LEFT OUTER JOIN srm_resources OWNERRES ON RIM_RISKS_AND_ISSUES.assigned_to = OWNERRES.USER_ID LEFT OUTER JOIN srm_resources RESBYRES ON RIM_RISKS_AND_ISSUES.resolved_by = RESBYRES.USER_ID JOIN srm_resources CREATED ON CREATED.user_id=rim_risks_and_issues.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=rim_risks_and_issues.last_updated_by  where 1 = 1AND RIM_RISKS_AND_ISSUES.TYPE_CODE='ISSUE' and dataw_context.is_dw_enabled=1</text>
  </QueryResult>
</ClarityDBViewQuery>
