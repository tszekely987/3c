<ClarityDBViewQuery>
  <QueryResult code="CMN_SEC_CHK_NO_USER_GLB_R_V0">
    <indexes/>
    <text_length>1245</text_length>
    <text>SELECT  UG.USER_ID,
        RI.OBJECT_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_GROUP_FLAT_HIERS H,
        CMN_SEC_GROUPS G,
        CMN_SEC_USER_GROUPS UG
WHERE   UG.GROUP_ID = H.PARENT_GROUP_ID
AND     UG.GROUP_ID = G.ID
AND     G.GROUP_ROLE_TYPE = 'GROUP'
AND     G.IS_ACTIVE = 1
AND     RI.IS_ACTIVE = 1
AND     RI.RIGHT_ID = H.GROUP_ID
UNION
SELECT -- USER RULE
        OS.PRINCIPAL_ID USER_ID,
        RI.OBJECT_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_ASSGND_RIGHT OS
WHERE   OS.INSTANCE_TYPE = 'SYSTEM'
AND     OS.PRINCIPAL_TYPE = 'USER'
AND     OS.RIGHT_ID = RI.RIGHT_ID
AND     RI.IS_ACTIVE = 1
UNION
SELECT -- OBS UNIT RULE FOR PRINCIPAL IS OBS
      R.USER_ID USER_ID,
      RI.OBJECT_ID,
      RI.PERMISSION_CODE,
      RI.PERMISSION_VALUE
FROM     CMN_SEC_RIGHT RI,
         CMN_SEC_ASSGND_RIGHT OS,
         OBS_UNIT_ENTITIES_V OU,
         SRM_RESOURCES R
WHERE    OS.PRINCIPAL_TYPE = OU.UNIT_MODE
AND      OS.PRINCIPAL_ID = OU.UNIT_ID
AND      OS.INSTANCE_TYPE = 'SYSTEM'
AND      OS.RIGHT_ID = RI.RIGHT_ID
AND      RI.IS_ACTIVE = 1
AND      OU.INSTANCE_ID = R.ID
AND      OU.TABLE_NAME = 'SRM_RESOURCES'
 </text>
  </QueryResult>
</ClarityDBViewQuery>
