<ClarityDBViewQuery>
  <QueryResult code="CMN_SEC_CHK_USER_R_V0">
    <indexes/>
    <text_length>1246</text_length>
    <text>SELECT  
        UG.USER_ID,
        RI.OBJECT_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_GROUP_FLAT_HIERS H,
        CMN_SEC_USER_GROUPS UG,
        CMN_SEC_GROUPS G        
WHERE   UG.GROUP_ID = H.PARENT_GROUP_ID
AND     UG.GROUP_ID = G.ID
AND     H.PARENT_GROUP_ID = G.ID
AND     G.GROUP_ROLE_TYPE = 'GROUP'
AND     G.IS_ACTIVE = 1
AND     RI.IS_ACTIVE = 1
AND     RI.RIGHT_ID = H.GROUP_ID  
UNION   
SELECT -- USER RULE
        OS.PRINCIPAL_ID USER_ID,
        RI.OBJECT_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE
FROM    CMN_SEC_ASSGND_RIGHT OS,
        CMN_SEC_RIGHT RI        
WHERE   OS.INSTANCE_TYPE = 'SYSTEM'
AND     OS.PRINCIPAL_TYPE = 'USER'
AND     OS.RIGHT_ID = RI.RIGHT_ID
AND     RI.IS_ACTIVE = 1
UNION
SELECT  -- OBS UNIT RULE FOR PRINCIPAL IS OBS
        U.USER_ID USER_ID,
        RI.OBJECT_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE
FROM    CMN_SEC_OBS_USERS_V U, 
        CMN_SEC_ASSGND_RIGHT AR,
        CMN_SEC_RIGHT RI        
WHERE   AR.PRINCIPAL_TYPE = U.UNIT_MODE
AND     AR.PRINCIPAL_ID = U.UNIT_ID
AND     AR.INSTANCE_TYPE = 'SYSTEM'
AND     AR.INSTANCE_ID is null
AND     AR.RIGHT_ID = RI.RIGHT_ID
AND     RI.IS_ACTIVE = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
