<ClarityDBViewQuery>
  <QueryResult code="CMN_SEC_CHK_INST_V">
    <indexes/>
    <text_length>4521</text_length>
    <text>SELECT  -- GROUP RULE
        UG.USER_ID,
        AP.OBJECT_ID,
        AP.OBJECT_INSTANCE_ID,
        PE.PERMISSION_CODE,
        PE.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_ASSGND_OBJ_PERM AP,
        CMN_SEC_PERM_ELEMENTS PE,
        CMN_SEC_GROUP_FLAT_HIERS H,
        CMN_SEC_USER_GROUPS UG,
        CMN_SEC_GROUPS PARENT_GROUP,
        CMN_SEC_GROUPS G,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O
WHERE   UG.GROUP_ID = H.GROUP_ID
AND     H.GROUP_ID = G.ID
AND     G.IS_ACTIVE = 1
AND     AP.PRINCIPAL_ID = H.PARENT_GROUP_ID
AND     H.PARENT_GROUP_ID = PARENT_GROUP.ID
AND     PARENT_GROUP.IS_ACTIVE = 1
AND     AP.PRINCIPAL_TYPE = 'GROUP'
AND     AP.PERMISSION_ID = PE.PERMISSION_ID
AND     U.ID = UG.USER_ID
AND     O.ID = AP.OBJECT_ID
UNION
SELECT  -- USER RULE
        AP.PRINCIPAL_ID USER_ID,
        AP.OBJECT_ID,
        AP.OBJECT_INSTANCE_ID,
        PE.PERMISSION_CODE,
        PE.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_ASSGND_OBJ_PERM AP,
        CMN_SEC_PERM_ELEMENTS PE,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O
WHERE   AP.PRINCIPAL_TYPE = 'USER'
AND     AP.PERMISSION_ID = PE.PERMISSION_ID
AND     U.ID = AP.PRINCIPAL_ID
AND     O.ID = AP.OBJECT_ID
UNION -- OBS UNIT RULES for principal is user
SELECT  OS.PRINCIPAL_ID USER_ID,
        RI.OBJECT_ID,
        OU.INSTANCE_ID OBJECT_INSTANCE_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_ASSGND_RIGHT OS,
        OBS_UNIT_ENTITIES_V OU,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O
WHERE   OS.PRINCIPAL_TYPE = 'USER'
AND     OS.INSTANCE_TYPE = OU.UNIT_MODE
AND     OS.INSTANCE_ID = OU.UNIT_ID
AND     RI.RIGHT_ID = OS.RIGHT_ID
AND     RI.IS_ACTIVE = 1
AND     UPPER(OU.TABLE_NAME) = UPPER(RI.RIGHT_TYPE)
AND     U.ID = OS.PRINCIPAL_ID
AND     O.ID = RI.OBJECT_ID
UNION -- OBS UNIT RULES for principal is group
SELECT  UG.USER_ID USER_ID,
        RI.OBJECT_ID,
        OU.INSTANCE_ID OBJECT_INSTANCE_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_ASSGND_RIGHT OS,
        CMN_SEC_GROUPS G,
        CMN_SEC_USER_GROUPS UG,
        OBS_UNIT_ENTITIES_V OU,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O
WHERE   OS.PRINCIPAL_TYPE = 'GROUP'
AND     OS.PRINCIPAL_ID = UG.GROUP_ID
AND     OS.INSTANCE_TYPE = OU.UNIT_MODE
AND     OS.INSTANCE_ID = OU.UNIT_ID
AND     G.ID = OS.PRINCIPAL_ID
AND     G.IS_ACTIVE = 1
AND     RI.IS_ACTIVE = 1
AND     UPPER(OU.TABLE_NAME) = UPPER(RI.RIGHT_TYPE)
AND     OS.RIGHT_ID = RI.RIGHT_ID
AND     U.ID = UG.USER_ID
AND     O.ID = RI.OBJECT_ID
UNION  -- OBS UNIT RULES FOR PRINCIPAL IS OBS, to an instance
SELECT  OU.USER_ID USER_ID,
        RI.OBJECT_ID,
        OS.INSTANCE_ID OBJECT_INSTANCE_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_ASSGND_RIGHT OS,
        CMN_SEC_OBS_USERS_V OU,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O
WHERE   OS.PRINCIPAL_TYPE = OU.UNIT_MODE
AND     OS.PRINCIPAL_ID = OU.UNIT_ID
AND     OS.INSTANCE_TYPE = 'INSTANCE'
AND     OS.RIGHT_ID = RI.RIGHT_ID
AND     RI.IS_ACTIVE = 1
AND     U.ID = OU.USER_ID
AND     O.ID = RI.OBJECT_ID
UNION  -- OBS UNIT RULES FOR PRINCIPAL IS OBS, to whole OBS
SELECT  OU1.USER_ID USER_ID,
        RI.OBJECT_ID,
        OU2.INSTANCE_ID OBJECT_INSTANCE_ID,
        RI.PERMISSION_CODE,
        RI.PERMISSION_VALUE,
        O.OBJECT_CODE,
        O.OBJECT_TYPE_CODE OBJECT_TYPE,
        O.COMPONENT_CODE,
        U.USER_NAME
FROM    CMN_SEC_RIGHT RI,
        CMN_SEC_ASSGND_RIGHT OS,
        CMN_SEC_OBS_USERS_V OU1,
        OBS_UNIT_ENTITIES_V OU2,
        CMN_SEC_USERS U,
        CMN_SEC_OBJECTS O        
WHERE   OS.PRINCIPAL_TYPE = OU1.UNIT_MODE
AND     OS.PRINCIPAL_ID = OU1.UNIT_ID
AND     OS.INSTANCE_TYPE = OU2.UNIT_MODE
AND     OS.INSTANCE_ID = OU2.UNIT_ID
AND     OS.RIGHT_ID = RI.RIGHT_ID
AND     RI.IS_ACTIVE = 1
AND     UPPER(OU2.TABLE_NAME) = UPPER(RI.RIGHT_TYPE)
AND     U.ID = OU1.USER_ID
AND     O.ID = RI.OBJECT_ID</text>
  </QueryResult>
</ClarityDBViewQuery>
