<ClarityDBViewQuery>
  <QueryResult code="DWH_RES_SKILL_MAPPING_V">
    <indexes/>
    <text_length>2054</text_length>
    <text>SELECT s.id res_skill_mapping_key,
       s.id clarity_res_skill_mapping_key,
	   s.skill_id res_skill_key,
       rs.skill_code skill_id,
       rs.skill_name skill_name,
       s.object_id resource_key,
       s.proficiency_level_id proficiency_level_key,
       s.interest_level_id interest_level_key,
	   s.weight weight,
       sf.hierarchy_level hierarchy_level,
       sf.level1_skill_id res_skill_level1_key,
       sf.level1_name res_skill_level1,
       sf.level2_skill_id res_skill_level2_key,
       sf.level2_name res_skill_level2,
       sf.level3_skill_id res_skill_level3_key,
       sf.level3_name res_skill_level3,
       sf.level4_skill_id res_skill_level4_key,
       sf.level4_name res_skill_level4,
       sf.level5_skill_id res_skill_level5_key,
       sf.level5_name res_skill_level5,
       sf.level6_skill_id res_skill_level6_key,
       sf.level6_name res_skill_level6,
       sf.level7_skill_id res_skill_level7_key,
       sf.level7_name res_skill_level7,
       sf.level8_skill_id res_skill_level8_key,
       sf.level8_name res_skill_level8,
       sf.level9_skill_id res_skill_level9_key,
       sf.level9_name res_skill_level9,
       sf.level10_skill_id res_skill_level10_key,
       sf.level10_name res_skill_level10,
       rs.skill_path skill_path,
	   s.created_date clarity_created_date,
	   GREATEST(sf.last_updated_date, NVL(p.last_updated_date,TO_DATE('01/01/1900','MM/DD/YYYY')), NVL(i.last_updated_date,TO_DATE('01/01/1900','MM/DD/YYYY'))) clarity_updated_date,
	   p.name proficiency_level,
	   i.name interest_level,
	   l.id language_code_key,
	   l.language_code language_code
FROM   rsm_skills_associations s
       INNER JOIN cmn_languages l ON l.is_dw_enabled = 1
       INNER JOIN rsm_skills rs ON s.skill_id = rs.id
       INNER JOIN rpt_res_skills_flat sf ON s.skill_id = sf.skill_id
       LEFT OUTER JOIN cmn_lookups_v p ON p.id = s.proficiency_level_id AND p.language_code = l.language_code
       LEFT OUTER JOIN cmn_lookups_v i ON i.id = s.interest_level_id AND i.language_code = l.language_code</text>
  </QueryResult>
</ClarityDBViewQuery>
