<ClarityDBViewQuery>
  <QueryResult code="DWH_INV_OBS_MAPPING_V">
    <indexes/>
    <text_length>1307</text_length>
    <text>SELECT obsa.id obs_mapping_key,
       obsa.id clarity_obs_mapping_key,
       obsa.record_id investment_key,
       u.obs_unit_key,
       u. obs_unit,
       u.obs_type_key,
       u.obs_type_id,
       u.obs_type,
       NVL(u.obs_level1_key,0) obs_level1_key,
       u.obs_level1,
       NVL(u.obs_level2_key,0) obs_level2_key,
       u.obs_level2,
       NVL(u.obs_level3_key,0) obs_level3_key,
       u.obs_level3,
       NVL(u.obs_level4_key,0) obs_level4_key,
       u.obs_level4,
       NVL(u.obs_level5_key,0) obs_level5_key,
       u.obs_level5,
       NVL(u.obs_level6_key,0) obs_level6_key,
       u.obs_level6,
       NVL(u.obs_level7_key,0) obs_level7_key,
       u.obs_level7,
       NVL(u.obs_level8_key,0) obs_level8_key,
       u.obs_level8,
       NVL(u.obs_level9_key,0) obs_level9_key,
       u.obs_level9,
       NVL(u.obs_level10_key,0) obs_level10_key,
       u.obs_level10,
       u.hierarchy_level,
       u.obs_path,
       obsa.created_date clarity_created_date,
       GREATEST(obsa.last_updated_date,u.last_updated_date) last_updated_date,
       obsa.table_name table_name
FROM   prj_obs_associations obsa
       INNER JOIN dwh_cfg_object_type o ON obsa.table_name = o.table_name AND o.is_investment = 1
       INNER JOIN dwh_lkp_obs_unit_v u ON obsa.unit_id = u.obs_unit_key</text>
  </QueryResult>
</ClarityDBViewQuery>
