<ClarityDBViewQuery>
  <QueryResult code="ODF_TEAM_V2">
    <indexes/>
    <text_length>7865</text_length>
    <text>select   'x' pmd_analytical_partition_by, prteam.prid odf_pk, srm_resources.defined_team_id as defined_team_id, prteam.forecast_rate as forecast_rate, prteam.prBooking as prbooking, (select cov.value from cmn_options co, cmn_option_values cov where co.id = cov.option_id and
        co.option_code = 'CMN_SYSTEM_CURRENCY') as forecast_currency, PRTEAM.HARD_START as por_hard_start, inv_investments.NAME as project_name, RES_MANAGER.USER_ID as res_mgr_id, INV_INVESTMENTS.NAME as investmentid, PRJ_RESOURCES.PRISROLE as isrole, prteam.ALLOCCOST_SUM as alloccost_sum, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN PRTEAM.HARD_SUM / 3600 / PRJ_HPD_FACTOR_FCT() ELSE
        PRTEAM.HARD_SUM END) as hard_sum, srm_resources.BOOK_MANAGER_ID as prbookmgrid, NVL(PRTEAM.PRAVAILSTART,INV_INVESTMENTS.SCHEDULE_START) as por_pravailstart, prteam.HARD_CURVE as hard_curve, prteam.capital_percentage as capitalpercentage, (CASE WHEN PRTEAM.PRAVAILSTART IS NULL THEN INV_INVESTMENTS.SCHEDULE_START ELSE PRTEAM.PRAVAILSTART END) as dwh_pravailstart, prteam.ODF_HARD_CURVE as hard_alloc_curve, INV_INVESTMENTS.ODF_OBJECT_CODE as investment_type, srm_resources.FULL_NAME as full_name, prteam.INCIDENT_ACT_CURVE as incident_act_curve, prteam.ALLOCCOST_CURVE as alloccost_curve, BASEREC.START_DATE as baseline_start, INV_INVESTMENTS.MANAGER_ID as proj_mgr_id, UPDATED.FULL_NAME as updated_by, (CASE WHEN NVL(PRTEAM.PRALLOCSUM,0) = 0 THEN 1 ELSE 0 END) as is_zero_alloc, (CASE WHEN PRJ_RESOURCES.PRISROLE = 1 THEN
        NVL(PRTEAM.REQUIREMENT_NAME,SUBSTR(SRM_RESOURCES.FULL_NAME,1,100))
        ELSE SRM_RESOURCES.FULL_NAME END) as requirement_name, prprojectid.odf_period_type as odf_period_type, prteam.prIsOpen as prisopen, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN ( NVL(PRTEAM.INCIDENT_ACT_SUM,0) +
        prj_sum_assignment_fct(prteam.prid,1) ) / 3600 / PRJ_HPD_FACTOR_FCT() ELSE (
        NVL(PRTEAM.INCIDENT_ACT_SUM,0) + prj_sum_assignment_fct(prteam.prid,1) ) END) as total_sum, inv_investments.currency_code as currency_code, prteam.prUID as pruid, prprojectid.odf_period_start as odf_period_start, prteam.ESTIMATES_CURVE as estimates_curve, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN (prj_sum_assignment_fct(prteam.prid, 1) / 3600) /
        PRJ_HPD_FACTOR_FCT() ELSE prj_sum_assignment_fct(prteam.prid,1) END) as actsum, (prj_sum_assignment_fct(prteam.prid,0)
        + prj_sum_assignment_fct(prteam.prid,1)
        ) / (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN (3600 * PRJ_HPD_FACTOR_FCT()) ELSE 1 END) as total_usage, srm_resources.DATE_OF_TERMINATION as prdot, prteam.HARDALLCCOST_CURVE as hardallccost_curve, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN PRTEAM.PRALLOCSUM / 3600 / PRJ_HPD_FACTOR_FCT() ELSE
        PRTEAM.PRALLOCSUM END) as prallocsum, prteam.prProjectID as prprojectid, srm_resources.EMAIL as email, inv_investments.IS_ACTIVE as proj_active, prteam.prAvailFinish as pravailfinish, PRTEAM.HARD_FINISH as por_hard_finish, prteam.HARDALLCCOST_SUM as hardallccost_sum, prteam.prResourceID as prresourceid, prteam.prRoleID as prroleid, (SELECT M.FULL_NAME FROM SRM_RESOURCES M WHERE M.USER_ID = INV_INVESTMENTS.MANAGER_ID) as proj_manager_name, prteam.ACTUALS_CURVE as actuals_curve, BASEREC.FINISH_DATE as baseline_finish, (CASE
        WHEN BASEREC.USAGE_SUM IS NULL THEN NULL
        ELSE
        (BASEREC.USAGE_SUM
        - (prj_sum_assignment_fct(prteam.prid,0)
        + prj_sum_assignment_fct(prteam.prid,1))
        ) / (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN (3600 * PRJ_HPD_FACTOR_FCT()) ELSE 1 END)
        END) as baseline_variance, inv_investments.priority as prpriority, (CASE WHEN PRTEAM.PRAVAILFINISH IS NULL THEN COP_CALC_FINISH_FCT(INV_INVESTMENTS.SCHEDULE_FINISH) ELSE COP_CALC_FINISH_FCT(PRTEAM.PRAVAILFINISH) END) as dwh_pravailfinish, prteam.ODF_PRALLOCCURVE as allocation_curve, PRJ_DEFAULT_ALLOC_RATE_FCT(PRTEAM.PRALLOCCURVE) as prallocdefault, prteam.RSF_OBSUNIT_ID as rsf_obsunit_id, inv_investments.CODE as project_id, inv_investments.SCHEDULE_FINISH as projectfinish, prj_resources.PRCATEGORY as prcategory, BASEREC.COST_SUM as baseline_cost, PRTeam.prID as dw_pk, prteam.prStatus as prstatus, srm_resources.DATE_OF_HIRE as prdoh, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN NVL(PRTEAM.INCIDENT_ACT_SUM,0) / 3600 /
        PRJ_HPD_FACTOR_FCT() ELSE NVL(PRTEAM.INCIDENT_ACT_SUM,0) END) as incident_act_sum, (NVL((SELECT 1 FROM DUAL WHERE EXISTS (SELECT 1 from NMC_CONVERSATIONS TC WHERE TC.RESOURCE_NAME='team' AND TC.RESOURCE_ID = prteam.prid)), 0)) as has_conversations, CREATED.FULL_NAME as created_by, prteam.HARD_START as hard_start, srm_resources.RESOURCE_TYPE as restype, (CASE
        WHEN PRJ_RESOURCES.PRISROLE = 1 THEN 'ROLE'
        WHEN SRM_RESOURCES.DEFINED_TEAM_ID IS NOT NULL THEN 'TEAM'
        ELSE 'RESOURCE'
        END) as staff_type, prteam.prProjectID as odf_parent_id, inv_investments.ODF_TEMPLATE as proj_template, inv_investments.progress as prprogress, srm_resources.PERSON_TYPE as employment_type, prteam.HARD_FINISH as hard_finish, prteam.REQUESTED_MANAGER_ID as requested_manager_id, prprojectid.odf_period_end as odf_period_end, prteam.SLICE_STATUS as slice_status, prteam.prAvailStart as pravailstart, srm_resources.IS_EXTERNAL as prexternal, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN (BASEREC.USAGE_SUM/3600) / PRJ_HPD_FACTOR_FCT() ELSE
        BASEREC.USAGE_SUM END) as baseline_usage, PRTEAM.LAST_UPDATED_DATE as last_updated_date, (CASE WHEN SRM_RESOURCES.RESOURCE_TYPE &lt; 2 THEN (prj_sum_assignment_fct(prteam.prid,0) / 3600) /
        PRJ_HPD_FACTOR_FCT() ELSE prj_sum_assignment_fct(prteam.prid,0) END) as estsum, NVL(PRTEAM.PRAVAILFINISH,INV_INVESTMENTS.SCHEDULE_FINISH) as por_pravailfinish, inv_investments.status as prinvstatus, prteam.RSF_RESUME_KEYWORDS as rsf_resume_keywords, INV_INVESTMENTS.ODF_OBJECT_CODE as inv_extended_types, (select count(1) from dual where exists (
        select 1
        from rsm_req_requisitions rq
        where rq.requirement_id = prteam.prid  and rq.status_code = (select lookup_code from cmn_lookups where lookup_type = 'REQUEST_STATUS_LIST' and lookup_enum = prteam.prstatus))) as has_requisitions, PRTEAM.PRID as replaceteamid, srm_resources.UNIQUE_NAME as res_code, RES_MANAGER.FULL_NAME as res_manager_name, prteam.RSF_PERSON_TYPE as rsf_person_type, inv_investments.SCHEDULE_START as projectstart, prteam.prAllocCurve as pralloccurve, (CASE WHEN INV_INVESTMENTS.STATUS = 1 OR INV_INVESTMENTS.STATUS = 5 THEN 1 ELSE 0 END) as is_approved, PRTEAM.CREATED_DATE as created_date, odf_ca_team.partition_code as partition_code, prj_max_actthru_fct(prteam.prprojectid, prteam.prresourceid) as practthru, prteam.TEAM_UID as team_uid, srm_resources.IS_ACTIVE as res_active, prprojectid.entity as odf_entity_code  from prteam prteam JOIN srm_resources CREATED ON CREATED.user_id=prteam.created_by JOIN srm_resources UPDATED ON UPDATED.user_id=prteam.last_updated_by JOIN srm_resources srm_resources ON srm_resources.id=prteam.prresourceid LEFT OUTER JOIN srm_resources RES_MANAGER ON SRM_RESOURCES.MANAGER_ID=RES_MANAGER.USER_ID JOIN prj_resources prj_resources ON prj_resources.prid=prteam.prresourceid JOIN inv_investments inv_investments ON inv_investments.id=prteam.prprojectid LEFT OUTER JOIN prj_baseline_details BASEREC ON BASEREC.OBJECT_ID = PRTeam.PRID AND BASEREC.OBJECT_TYPE='TEAM' and BASEREC.IS_CURRENT = 1 JOIN odf_ca_team odf_ca_team ON odf_ca_team.id=prteam.prid JOIN (select   'x' pmd_analytical_partition_by, inv_investments.id odf_pk, odf_ca_inv.odf_period_type as odf_period_type, odf_ca_inv.odf_period_start as odf_period_start, inv_investments.entity_code as entity, odf_ca_inv.odf_period_end as odf_period_end from inv_investments inv_investments JOIN odf_ca_inv odf_ca_inv ON odf_ca_inv.id=inv_investments.id where 1 = 1 )  prprojectid ON prprojectid.odf_pk=prteam.prProjectID  where 1 = 1</text>
  </QueryResult>
</ClarityDBViewQuery>
