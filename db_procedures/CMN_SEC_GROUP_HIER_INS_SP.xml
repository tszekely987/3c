<?xml version="1.0" encoding="UTF-8" standalone="no"?><QueryResult xmlns="http://www.niku.com/xog/Query" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <Code>capture3c.get_db_procedure</Code>
      <Records>
        <Record>
          <code>CMN_SEC_GROUP_HIER_INS_SP</code>
          <parallel>NO</parallel>
          <definition>
  CREATE OR REPLACE EDITIONABLE PROCEDURE "PPM"."CMN_SEC_GROUP_HIER_INS_SP" (P_CHILD_GROUP_CODE IN VARCHAR2, P_PARENT_GROUP_CODE IN VARCHAR2, P_CREATED_BY IN NUMBER DEFAULT 1)
IS
   V_ID                          NUMBER;
   V_CNT                         INTEGER := 0;
   V_CNT1                        INTEGER := 0;
   V_CNT2                        INTEGER := 0;
BEGIN
   SELECT   CMN_SEC_GROUP_HIERARCHIES_S1.NEXTVAL
   INTO     V_ID
   FROM     DUAL;
   SELECT   COUNT (*)
   INTO     V_CNT1
   FROM     CMN_SEC_GROUPS
   WHERE    GROUP_CODE = P_CHILD_GROUP_CODE;
   SELECT   COUNT (*)
   INTO     V_CNT2
   FROM     CMN_SEC_GROUPS
   WHERE    GROUP_CODE = P_PARENT_GROUP_CODE;

   IF    V_CNT1 = 0
      OR V_CNT2 = 0
   THEN
      RAISE_APPLICATION_ERROR (-20007, 'GROUP_CODE OR PARENT_GROUP_CODE DOES NOT EXIST');
   END IF;

   SELECT   COUNT (*)
   INTO     V_CNT
   FROM     CMN_SEC_GROUP_HIERARCHIES H,
            CMN_SEC_GROUPS CHILD,
            CMN_SEC_GROUPS PARENT
   WHERE    CHILD.GROUP_CODE = P_CHILD_GROUP_CODE
   AND      PARENT.GROUP_CODE = P_PARENT_GROUP_CODE
   AND      H.GROUP_ID = CHILD.ID
   AND      H.PARENT_GROUP_ID = PARENT.ID;

   IF V_CNT &gt; 0
   THEN
      RAISE_APPLICATION_ERROR (-20000, 'RECORD EXISTS');
   ELSE
      INSERT INTO CMN_SEC_GROUP_HIERARCHIES
                  (ID, GROUP_ID, PARENT_GROUP_ID, CREATED_DATE, CREATED_BY, LAST_UPDATED_DATE, LAST_UPDATED_BY)
         SELECT   V_ID, CHILD.ID, PARENT.ID, SYSDATE, P_CREATED_BY, SYSDATE, P_CREATED_BY
         FROM     CMN_SEC_GROUPS CHILD,
                  CMN_SEC_GROUPS PARENT
         WHERE    CHILD.GROUP_CODE = P_CHILD_GROUP_CODE
         AND      PARENT.GROUP_CODE = P_PARENT_GROUP_CODE
         AND      NOT EXISTS (SELECT   'PARENT/CHILD COMBO ALREADY EXISTS'
                              FROM     CMN_SEC_GROUP_HIERARCHIES H,
                                       CMN_SEC_GROUPS CHILD1,
                                       CMN_SEC_GROUPS PARENT1
                              WHERE    CHILD1.GROUP_CODE = P_CHILD_GROUP_CODE
                              AND      PARENT1.GROUP_CODE = P_PARENT_GROUP_CODE
                              AND      H.GROUP_ID = CHILD1.ID
                              AND      H.PARENT_GROUP_ID = PARENT1.ID);
   END IF;
END;
 
 
 
 
 </definition>
        </Record>
      </Records>
      <Slice>
        <Number>0</Number>
        <Size>1</Size>
        <Total>1</Total>
      </Slice>
    </QueryResult>