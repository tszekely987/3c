<?xml version="1.0" encoding="UTF-8" standalone="no"?><NikuDataBus xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../xsd/nikuxog_contentPack.xsd">
      <Header action="write" externalSource="NIKU" objectType="contentPack" version="16.1.2.1567"/>
      <contentPack update="true">
        <queries update="true">
          <query code="capture3c.get_all_locations" isUserPortletAvailable="1" source="customer">
            
            
            
            
            <nls languageCode="en" name="capture3c.get_all_locations"/>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <nsql dbId="Niku" dbVendor="all"><![CDATA[SELECT @SELECT:DIM:USER_DEF:IMPLIED:LOCATIONS:X.ENTITY:CODE@,
@SELECT:DIM_PROP:USER_DEF:IMPLIED:LOCATIONS:X.LAST_UPDATED_DATE:LAST_UPDATED_DATE@,
@SELECT:DIM_PROP:USER_DEF:IMPLIED:LOCATIONS:X.LAST_UPDATED_BY:LAST_UPDATED_BY@
FROM
(
	SELECT DISTINCT ent.entity,
		loc.last_updated_date,
		csu.user_name AS last_updated_by
	FROM entity ent
	JOIN locations loc ON loc.entity_id = ent.id
	LEFT JOIN cmn_sec_users csu ON csu.id = loc.last_updated_by
	WHERE EXISTS
		(
			SELECT sq.entity, sq.last_updated_date
			FROM
			(
				SELECT e.entity, MAX(l.last_updated_date) AS last_updated_date
				FROM entity e
				JOIN locations l ON l.entity_id = e.id
				GROUP BY e.entity
			) sq
			WHERE sq.entity = ent.entity
				AND sq.last_updated_date = loc.last_updated_date
		)
) x
WHERE @FILTER@]]></nsql>
            <attribute id="code" required="false"/>
            <attribute id="last_updated_date" required="false"/>
            <attribute id="last_updated_by" required="false"/>
          </query>
        </queries>
      </contentPack>
    </NikuDataBus>